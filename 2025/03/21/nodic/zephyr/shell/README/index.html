<!DOCTYPE html><html lang="cn" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Zephyr Shell 命令系统指南 | JoeNero的博客</title><meta name="author" content="JoeNero"><meta name="copyright" content="JoeNero"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Zephyr Shell 命令系统指南1. Shell系统架构1.1 整体架构123456789101112graph TD    A[用户输入] --&gt; B[Shell核心]    B --&gt; C[命令处理器]    C --&gt; D[命令实现]    D --&gt; E[系统功能]        subgraph &quot;Shell组件&quot;        F[命令">
<meta property="og:type" content="article">
<meta property="og:title" content="Zephyr Shell 命令系统指南">
<meta property="og:url" content="https://joeforkyou.github.io/2025/03/21/nodic/zephyr/shell/README/index.html">
<meta property="og:site_name" content="JoeNero的博客">
<meta property="og:description" content="Zephyr Shell 命令系统指南1. Shell系统架构1.1 整体架构123456789101112graph TD    A[用户输入] --&gt; B[Shell核心]    B --&gt; C[命令处理器]    C --&gt; D[命令实现]    D --&gt; E[系统功能]        subgraph &quot;Shell组件&quot;        F[命令">
<meta property="og:locale">
<meta property="og:image" content="https://joeforkyou.github.io/img/%E7%BE%8E%E5%A5%B3.jpg">
<meta property="article:published_time" content="2025-03-21T12:49:56.000Z">
<meta property="article:modified_time" content="2025-03-21T14:16:43.017Z">
<meta property="article:author" content="JoeNero">
<meta property="article:tag" content="zephyr">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://joeforkyou.github.io/img/%E7%BE%8E%E5%A5%B3.jpg"><link rel="shortcut icon" href="/img/1.jpg"><link rel="canonical" href="https://joeforkyou.github.io/2025/03/21/nodic/zephyr/shell/README/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"IZ845G3SQG","apiKey":"381e98702820650923216a5f47f18d71","indexName":"movie","hitsPerPage":6,"languages":{"input_placeholder":"Search for Posts","hits_empty":"No results found for: ${query}","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Zephyr Shell 命令系统指南',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="JoeNero的博客" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/%E7%BE%8E%E5%A5%B3.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">126</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">26</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-image"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">JoeNero的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">Zephyr Shell 命令系统指南</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-image"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Zephyr Shell 命令系统指南</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-03-21T14:16:43.017Z" title="Updated 2025-03-21 22:16:43">2025-03-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/zephyr/">zephyr</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Zephyr-Shell-命令系统指南"><a href="#Zephyr-Shell-命令系统指南" class="headerlink" title="Zephyr Shell 命令系统指南"></a>Zephyr Shell 命令系统指南</h1><h2 id="1-Shell系统架构"><a href="#1-Shell系统架构" class="headerlink" title="1. Shell系统架构"></a>1. Shell系统架构</h2><h3 id="1-1-整体架构"><a href="#1-1-整体架构" class="headerlink" title="1.1 整体架构"></a>1.1 整体架构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    A[用户输入] --&gt; B[Shell核心]</span><br><span class="line">    B --&gt; C[命令处理器]</span><br><span class="line">    C --&gt; D[命令实现]</span><br><span class="line">    D --&gt; E[系统功能]</span><br><span class="line">    </span><br><span class="line">    subgraph &quot;Shell组件&quot;</span><br><span class="line">        F[命令注册]</span><br><span class="line">        G[参数解析]</span><br><span class="line">        H[历史记录]</span><br><span class="line">        I[自动完成]</span><br><span class="line">    end</span><br></pre></td></tr></table></figure>

<h3 id="1-2-基本配置"><a href="#1-2-基本配置" class="headerlink" title="1.2 基本配置"></a>1.2 基本配置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># Shell基本支持</span><br><span class="line">CONFIG_SHELL=y</span><br><span class="line"></span><br><span class="line"># 历史记录支持</span><br><span class="line">CONFIG_SHELL_HISTORY=y</span><br><span class="line"></span><br><span class="line"># 通配符支持</span><br><span class="line">CONFIG_SHELL_WILDCARD=y</span><br><span class="line"></span><br><span class="line"># 命令日志</span><br><span class="line">CONFIG_SHELL_LOGGING=y</span><br><span class="line"></span><br><span class="line"># 彩色输出</span><br><span class="line">CONFIG_SHELL_VT100_COLORS=y</span><br></pre></td></tr></table></figure>

<h2 id="2-命令实现"><a href="#2-命令实现" class="headerlink" title="2. 命令实现"></a>2. 命令实现</h2><h3 id="2-1-基本命令"><a href="#2-1-基本命令" class="headerlink" title="2.1 基本命令"></a>2.1 基本命令</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/shell/shell.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 简单命令 */</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">cmd_hello</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> shell *shell,</span></span><br><span class="line"><span class="params">                    <span class="type">size_t</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    shell_print(shell, <span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 注册命令 */</span></span><br><span class="line">SHELL_CMD_REGISTER(hello, <span class="literal">NULL</span>,</span><br><span class="line">                  <span class="string">&quot;Print Hello World&quot;</span>,</span><br><span class="line">                  cmd_hello);</span><br></pre></td></tr></table></figure>

<h3 id="2-2-子命令"><a href="#2-2-子命令" class="headerlink" title="2.2 子命令"></a>2.2 子命令</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/shell/shell.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 子命令处理函数 */</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">cmd_demo_sub1</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> shell *shell,</span></span><br><span class="line"><span class="params">                        <span class="type">size_t</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    shell_print(shell, <span class="string">&quot;Subcommand 1&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">cmd_demo_sub2</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> shell *shell,</span></span><br><span class="line"><span class="params">                        <span class="type">size_t</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    shell_print(shell, <span class="string">&quot;Subcommand 2&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 子命令结构 */</span></span><br><span class="line">SHELL_STATIC_SUBCMD_SET_CREATE(sub_demo,</span><br><span class="line">    SHELL_CMD(sub1, <span class="literal">NULL</span>, <span class="string">&quot;Subcommand 1&quot;</span>, cmd_demo_sub1),</span><br><span class="line">    SHELL_CMD(sub2, <span class="literal">NULL</span>, <span class="string">&quot;Subcommand 2&quot;</span>, cmd_demo_sub2),</span><br><span class="line">    SHELL_SUBCMD_SET_END</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 注册主命令 */</span></span><br><span class="line">SHELL_CMD_REGISTER(demo, &amp;sub_demo,</span><br><span class="line">                  <span class="string">&quot;Demo commands&quot;</span>, <span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure>

<h2 id="3-参数处理"><a href="#3-参数处理" class="headerlink" title="3. 参数处理"></a>3. 参数处理</h2><h3 id="3-1-参数解析"><a href="#3-1-参数解析" class="headerlink" title="3.1 参数解析"></a>3.1 参数解析</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/shell/shell.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 带参数的命令 */</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">cmd_params</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> shell *shell,</span></span><br><span class="line"><span class="params">                     <span class="type">size_t</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (argc &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        shell_error(shell, <span class="string">&quot;Missing parameters!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> -EINVAL;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    shell_print(shell, <span class="string">&quot;Parameter 1: %s&quot;</span>, argv[<span class="number">1</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (argc &gt; <span class="number">2</span>) &#123;</span><br><span class="line">        shell_print(shell, <span class="string">&quot;Parameter 2: %s&quot;</span>, argv[<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 注册命令 */</span></span><br><span class="line">SHELL_CMD_REGISTER(params, <span class="literal">NULL</span>,</span><br><span class="line">                  <span class="string">&quot;Command with parameters&quot;</span>,</span><br><span class="line">                  cmd_params);</span><br></pre></td></tr></table></figure>

<h3 id="3-2-参数验证"><a href="#3-2-参数验证" class="headerlink" title="3.2 参数验证"></a>3.2 参数验证</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/shell/shell.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">cmd_number</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> shell *shell,</span></span><br><span class="line"><span class="params">                     <span class="type">size_t</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">long</span> number;</span><br><span class="line">    <span class="type">char</span> *endptr;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">2</span>) &#123;</span><br><span class="line">        shell_error(shell, <span class="string">&quot;Exactly one parameter required!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> -EINVAL;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 转换并验证数字参数 */</span></span><br><span class="line">    number = strtol(argv[<span class="number">1</span>], &amp;endptr, <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">if</span> (*endptr != <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">        shell_error(shell, <span class="string">&quot;Invalid number format!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> -EINVAL;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    shell_print(shell, <span class="string">&quot;Number: %ld&quot;</span>, number);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-输出格式化"><a href="#4-输出格式化" class="headerlink" title="4. 输出格式化"></a>4. 输出格式化</h2><h3 id="4-1-基本输出"><a href="#4-1-基本输出" class="headerlink" title="4.1 基本输出"></a>4.1 基本输出</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/shell/shell.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">shell_output_example</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> shell *shell)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* 普通输出 */</span></span><br><span class="line">    shell_print(shell, <span class="string">&quot;Normal message&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 警告输出 */</span></span><br><span class="line">    shell_warn(shell, <span class="string">&quot;Warning message&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 错误输出 */</span></span><br><span class="line">    shell_error(shell, <span class="string">&quot;Error message&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 格式化输出 */</span></span><br><span class="line">    shell_print(shell, <span class="string">&quot;Value: %d&quot;</span>, <span class="number">42</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 多行输出 */</span></span><br><span class="line">    shell_print(shell, <span class="string">&quot;Line 1\n&quot;</span></span><br><span class="line">                      <span class="string">&quot;Line 2\n&quot;</span></span><br><span class="line">                      <span class="string">&quot;Line 3&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-表格输出"><a href="#4-2-表格输出" class="headerlink" title="4.2 表格输出"></a>4.2 表格输出</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/shell/shell.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">print_table</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> shell *shell)</span></span><br><span class="line">&#123;</span><br><span class="line">    shell_print(shell, <span class="string">&quot;| %-10s | %-8s | %-8s |&quot;</span>,</span><br><span class="line">                <span class="string">&quot;Name&quot;</span>, <span class="string">&quot;Value&quot;</span>, <span class="string">&quot;Unit&quot;</span>);</span><br><span class="line">    shell_print(shell, <span class="string">&quot;|------------|----------|----------|&quot;</span>);</span><br><span class="line">    shell_print(shell, <span class="string">&quot;| %-10s | %8d | %-8s |&quot;</span>,</span><br><span class="line">                <span class="string">&quot;Temperature&quot;</span>, <span class="number">25</span>, <span class="string">&quot;°C&quot;</span>);</span><br><span class="line">    shell_print(shell, <span class="string">&quot;| %-10s | %8d | %-8s |&quot;</span>,</span><br><span class="line">                <span class="string">&quot;Pressure&quot;</span>, <span class="number">1013</span>, <span class="string">&quot;hPa&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-动态命令"><a href="#5-动态命令" class="headerlink" title="5. 动态命令"></a>5. 动态命令</h2><h3 id="5-1-运行时注册"><a href="#5-1-运行时注册" class="headerlink" title="5.1 运行时注册"></a>5.1 运行时注册</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/shell/shell.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 动态命令结构 */</span></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">shell_static_entry</span> <span class="title">dynamic_cmd</span> =</span> &#123;</span><br><span class="line">    .syntax = <span class="string">&quot;dynamic&quot;</span>,</span><br><span class="line">    .help = <span class="string">&quot;Dynamic command&quot;</span>,</span><br><span class="line">    .handler = <span class="literal">NULL</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 注册动态命令 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">register_dynamic_command</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    dynamic_cmd.handler = cmd_handler;</span><br><span class="line">    shell_cmd_register(&amp;dynamic_cmd);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 注销动态命令 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">unregister_dynamic_command</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    shell_cmd_unregister(&amp;dynamic_cmd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-2-动态子命令"><a href="#5-2-动态子命令" class="headerlink" title="5.2 动态子命令"></a>5.2 动态子命令</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/shell/shell.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 动态子命令数组 */</span></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">shell_static_entry</span> *<span class="title">dynamic_sub_commands</span>[10];</span></span><br><span class="line"><span class="type">static</span> <span class="type">size_t</span> dynamic_cmd_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 添加动态子命令 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">add_dynamic_subcommand</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *name,</span></span><br><span class="line"><span class="params">                           <span class="type">shell_cmd_handler_t</span> handler)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (dynamic_cmd_count &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">shell_static_entry</span> *<span class="title">entry</span> =</span></span><br><span class="line">        k_malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> shell_static_entry));</span><br><span class="line">        </span><br><span class="line">    entry-&gt;syntax = name;</span><br><span class="line">    entry-&gt;handler = handler;</span><br><span class="line">    entry-&gt;help = <span class="string">&quot;Dynamic subcommand&quot;</span>;</span><br><span class="line">    entry-&gt;subcmd = <span class="literal">NULL</span>;</span><br><span class="line">    </span><br><span class="line">    dynamic_sub_commands[dynamic_cmd_count++] = entry;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-自定义Shell后端"><a href="#6-自定义Shell后端" class="headerlink" title="6. 自定义Shell后端"></a>6. 自定义Shell后端</h2><h3 id="6-1-基本实现"><a href="#6-1-基本实现" class="headerlink" title="6.1 基本实现"></a>6.1 基本实现</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/shell/shell.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Shell传输接口 */</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">custom_transport_init</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> shell_transport *transport)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* 初始化自定义传输 */</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">custom_transport_write</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> shell_transport *transport,</span></span><br><span class="line"><span class="params">                                <span class="type">const</span> <span class="type">void</span> *data, <span class="type">size_t</span> length)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* 实现写数据 */</span></span><br><span class="line">    <span class="keyword">return</span> length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">custom_transport_read</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> shell_transport *transport,</span></span><br><span class="line"><span class="params">                               <span class="type">void</span> *data, <span class="type">size_t</span> length, <span class="type">size_t</span> *cnt)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* 实现读数据 */</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 传输接口结构 */</span></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">shell_transport_api</span> <span class="title">custom_transport_api</span> =</span> &#123;</span><br><span class="line">    .init = custom_transport_init,</span><br><span class="line">    .write = custom_transport_write,</span><br><span class="line">    .read = custom_transport_read</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Shell传输实例 */</span></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">shell_transport</span> <span class="title">custom_transport</span> =</span> &#123;</span><br><span class="line">    .api = &amp;custom_transport_api,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Shell实例 */</span></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">shell_custom</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">shell</span> <span class="title">shell</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">shell_transport</span> <span class="title">transport</span>;</span></span><br><span class="line">&#125; shell_custom_instance = &#123;</span><br><span class="line">    .transport = custom_transport</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="6-2-注册自定义Shell"><a href="#6-2-注册自定义Shell" class="headerlink" title="6.2 注册自定义Shell"></a>6.2 注册自定义Shell</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/shell/shell.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">init_custom_shell</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">shell_backend_config_flags</span> <span class="title">cfg_flags</span> =</span> &#123;</span><br><span class="line">        .insert_mode = <span class="number">0</span>,</span><br><span class="line">        .echo = <span class="number">1</span>,</span><br><span class="line">        .obscure = <span class="number">0</span>,</span><br><span class="line">        .mode_echo = <span class="number">0</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    shell_init(&amp;shell_custom_instance.shell,</span><br><span class="line">               &amp;custom_transport,</span><br><span class="line">               &amp;cfg_flags,</span><br><span class="line">               <span class="literal">true</span>,</span><br><span class="line">               <span class="literal">true</span>,</span><br><span class="line">               SHELL_LOG_LEVEL_INF);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-高级功能"><a href="#7-高级功能" class="headerlink" title="7. 高级功能"></a>7. 高级功能</h2><h3 id="7-1-命令别名"><a href="#7-1-命令别名" class="headerlink" title="7.1 命令别名"></a>7.1 命令别名</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/shell/shell.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 创建命令别名 */</span></span><br><span class="line">SHELL_CMD_ARG_REGISTER(ls, <span class="literal">NULL</span>,</span><br><span class="line">                      <span class="string">&quot;List files (alias for dir)&quot;</span>,</span><br><span class="line">                      cmd_dir, <span class="number">1</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h3 id="7-2-命令组"><a href="#7-2-命令组" class="headerlink" title="7.2 命令组"></a>7.2 命令组</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/shell/shell.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 创建命令组 */</span></span><br><span class="line">SHELL_STATIC_SUBCMD_SET_CREATE(utils_cmds,</span><br><span class="line">    SHELL_CMD(version, <span class="literal">NULL</span>, <span class="string">&quot;Show version&quot;</span>, cmd_version),</span><br><span class="line">    SHELL_CMD(info, <span class="literal">NULL</span>, <span class="string">&quot;Show system info&quot;</span>, cmd_info),</span><br><span class="line">    SHELL_CMD(stats, <span class="literal">NULL</span>, <span class="string">&quot;Show statistics&quot;</span>, cmd_stats),</span><br><span class="line">    SHELL_SUBCMD_SET_END</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">SHELL_CMD_REGISTER(utils, &amp;utils_cmds,</span><br><span class="line">                  <span class="string">&quot;Utility commands&quot;</span>, <span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure>

<h2 id="8-实际应用示例"><a href="#8-实际应用示例" class="headerlink" title="8. 实际应用示例"></a>8. 实际应用示例</h2><h3 id="8-1-系统监控命令"><a href="#8-1-系统监控命令" class="headerlink" title="8.1 系统监控命令"></a>8.1 系统监控命令</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/shell/shell.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/kernel.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 系统信息命令 */</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">cmd_sysinfo</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> shell *shell,</span></span><br><span class="line"><span class="params">                      <span class="type">size_t</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    shell_print(shell, <span class="string">&quot;System Information:&quot;</span>);</span><br><span class="line">    shell_print(shell, <span class="string">&quot;Uptime: %lld ms&quot;</span>,</span><br><span class="line">                k_uptime_get());</span><br><span class="line">    shell_print(shell, <span class="string">&quot;Active threads: %d&quot;</span>,</span><br><span class="line">                k_thread_count_get());</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 内存信息命令 */</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">cmd_meminfo</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> shell *shell,</span></span><br><span class="line"><span class="params">                      <span class="type">size_t</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    shell_print(shell, <span class="string">&quot;Memory Information:&quot;</span>);</span><br><span class="line">    <span class="comment">/* 添加内存统计信息 */</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 注册系统监控命令 */</span></span><br><span class="line">SHELL_STATIC_SUBCMD_SET_CREATE(monitor_cmds,</span><br><span class="line">    SHELL_CMD(sysinfo, <span class="literal">NULL</span>,</span><br><span class="line">              <span class="string">&quot;Show system information&quot;</span>,</span><br><span class="line">              cmd_sysinfo),</span><br><span class="line">    SHELL_CMD(meminfo, <span class="literal">NULL</span>,</span><br><span class="line">              <span class="string">&quot;Show memory information&quot;</span>,</span><br><span class="line">              cmd_meminfo),</span><br><span class="line">    SHELL_SUBCMD_SET_END</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">SHELL_CMD_REGISTER(monitor, &amp;monitor_cmds,</span><br><span class="line">                  <span class="string">&quot;System monitoring commands&quot;</span>, <span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure>

<h3 id="8-2-设备控制命令"><a href="#8-2-设备控制命令" class="headerlink" title="8.2 设备控制命令"></a>8.2 设备控制命令</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/shell/shell.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/drivers/gpio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* LED控制命令 */</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">cmd_led_control</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> shell *shell,</span></span><br><span class="line"><span class="params">                          <span class="type">size_t</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">device</span> *<span class="title">dev</span>;</span></span><br><span class="line">    <span class="type">int</span> pin;</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">3</span>) &#123;</span><br><span class="line">        shell_error(shell, <span class="string">&quot;Usage: led &lt;pin&gt; &lt;0|1&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> -EINVAL;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    pin = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">    value = atoi(argv[<span class="number">2</span>]);</span><br><span class="line">    </span><br><span class="line">    dev = device_get_binding(<span class="string">&quot;GPIO_0&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!dev) &#123;</span><br><span class="line">        shell_error(shell, <span class="string">&quot;GPIO device not found&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> -ENODEV;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    gpio_pin_configure(dev, pin, GPIO_OUTPUT);</span><br><span class="line">    gpio_pin_set(dev, pin, value);</span><br><span class="line">    </span><br><span class="line">    shell_print(shell, <span class="string">&quot;LED %d set to %d&quot;</span>, pin, value);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 注册设备控制命令 */</span></span><br><span class="line">SHELL_CMD_REGISTER(led, <span class="literal">NULL</span>,</span><br><span class="line">                  <span class="string">&quot;LED control command&quot;</span>,</span><br><span class="line">                  cmd_led_control);</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://joeforkyou.github.io">JoeNero</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://joeforkyou.github.io/2025/03/21/nodic/zephyr/shell/README/">https://joeforkyou.github.io/2025/03/21/nodic/zephyr/shell/README/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/zephyr/">zephyr</a></div><div class="post-share"><div class="social-share" data-image="/img/%E7%BE%8E%E5%A5%B3.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/03/21/nodic/zephyr/security/README/" title="Zephyr 安全子系统指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Zephyr 安全子系统指南</div></div><div class="info-2"><div class="info-item-1">Zephyr 安全子系统指南1. 安全子系统概述Zephyr RTOS 提供了多层次的安全机制，包括：  内存保护 线程隔离 加密服务 安全启动 访问控制  2. 内存保护2.1 配置 (prj.conf)12345# 内存保护配置CONFIG_USERSPACE=yCONFIG_MPU_STACK_GUARD=yCONFIG_THREAD_STACK_INFO=yCONFIG_THREAD_CUSTOM_DATA=y  2.2 用户空间线程123456789101112131415161718#include &lt;zephyr/kernel.h&gt;#include &lt;zephyr/sys/libc-hooks.h&gt;#define STACK_SIZE 1024#define THREAD_PRIORITY 5/* 用户线程函数 */void user_thread_entry(void *p1, void *p2, void *p3)&#123;    while (1) &#123;        /* 用户空间操作 */       ...</div></div></div></a><a class="pagination-related" href="/2025/03/21/nodic/zephyr/timing/README/" title="Zephyr 定时系统指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Zephyr 定时系统指南</div></div><div class="info-2"><div class="info-item-1">Zephyr 时间管理指南1. 时间管理配置1.1 基础配置 (prj.conf)1234567891011121314# 系统时钟配置CONFIG_SYS_CLOCK_TICKS_PER_SEC=1000CONFIG_TICKLESS_KERNEL=y# 定时器配置CONFIG_TIMER_HAS_64BIT_CYCLE_COUNTER=yCONFIG_TIMER_READS_ITS_FREQUENCY_AT_RUNTIME=y# RTC配置（如果使用）CONFIG_COUNTER=yCONFIG_COUNTER_RTC0=y# 时间测量配置CONFIG_TIMING_FUNCTIONS=y  1.2 时钟源配置 (boards&#x2F;xxx.overlay)12345678910/ &#123;    soc &#123;        timer0: timer@40000000 &#123;            compatible = &quot;nordic,nrf-timer&quot;;            reg = &lt;0x40000000...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/03/20/zephyer/zephyer1/" title="【Zephyr】【一】Zephyr RTOS 示例代码集"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-20</div><div class="info-item-2">【Zephyr】【一】Zephyr RTOS 示例代码集</div></div><div class="info-2"><div class="info-item-1">Zephyr RTOS 示例代码集1. 基础示例1.0 基础配置每个示例都需要一个 prj.conf 文件来配置项目。以下是各个示例所需的配置： 基础示例 prj.conf1234567891011# 控制台输出CONFIG_PRINTK=yCONFIG_SERIAL=yCONFIG_UART_CONSOLE=y# 日志系统CONFIG_LOG=yCONFIG_LOG_DEFAULT_LEVEL=3# 内核配置CONFIG_KERNEL_BIN_NAME=&quot;app&quot;  线程示例 prj.conf123456789# 基础配置CONFIG_PRINTK=yCONFIG_SERIAL=yCONFIG_UART_CONSOLE=y# 线程配置CONFIG_THREAD_NAME=yCONFIG_THREAD_MONITOR=yCONFIG_THREAD_STACK_INFO=y  1.1 Hello...</div></div></div></a><a class="pagination-related" href="/2025/03/20/zephyer/zephyr2/" title="【Zephyr】【二】Zephyr RTOS 系统架构"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-20</div><div class="info-item-2">【Zephyr】【二】Zephyr RTOS 系统架构</div></div><div class="info-2"><div class="info-item-1"> mermaid.initialize({startOnLoad:true});  Zephyr RTOS 系统架构整体架构 graph TB     subgraph "应用层"         App1[应用1]         App2[应用2]         App3[应用3]     end     subgraph "系统服务层"         FS[文件系统]         Net[网络协议栈]         Shell[命令行界面]     end     subgraph "内核层"         Sched[调度器]         Mem[内存管理]         IPC[进程间通信]         Time[时间管理]     end     subgraph "硬件抽象层"         GPIO[GPIO驱动]         UART[串口驱动]         SPI[SPI驱动]         I2C[I2C驱动]     end     App1 & App2 & App3 --> FS & Net & Shell    ...</div></div></div></a><a class="pagination-related" href="/2023/12/21/nodic/zephyr/architecture/devicetree/" title="Zephyr 设备树"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-21</div><div class="info-item-2">Zephyr 设备树</div></div><div class="info-2"><div class="info-item-1">Zephyr 设备树版本信息 版本：V1.0 更新时间：2025年03月20日 23:15  设备树（Device Tree）是 Zephyr RTOS 用于描述硬件配置的机制。它提供了一种统一的方式来描述系统硬件，使得硬件配置与软件代码分离，提高了代码的可移植性和可维护性。 设备树概述什么是设备树设备树是一种描述硬件的数据结构，它以树形结构表示硬件设备及其属性。在 Zephyr 中，设备树用于：  描述硬件配置 生成设备驱动的初始化代码 配置中断和引脚复用 定义内存映射  设备树的优势 硬件描述与软件分离：便于硬件配置的修改和维护 跨平台兼容性：同一套代码可以适用于不同的硬件平台 动态配置：支持运行时修改设备配置 标准化：采用行业标准的描述方式，提高可读性和互操作性  设备树语法基本结构设备树文件（.dts）的基本结构如下： 123456789101112131415161718/dts-v1/;/ &#123;    model = &quot;Example Board&quot;;    compatible = &quot;example,board&quot;;  ...</div></div></div></a><a class="pagination-related" href="/2025/03/20/nodic/zephyr/architecture/README/" title="Zephyr RTOS 系统架构"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-20</div><div class="info-item-2">Zephyr RTOS 系统架构</div></div><div class="info-2"><div class="info-item-1">Zephyr RTOS 系统架构版本信息 版本：V1.0 更新时间：2025年03月20日 22:30  Zephyr RTOS 是一个模块化、可扩展的实时操作系统，设计用于资源受限的嵌入式系统。本章节将介绍 Zephyr 的整体系统架构。 目录 内核架构 硬件支持 设备树 驱动模型  架构概览Zephyr 的系统架构主要包括以下几个部分：  微内核  提供基本的线程管理、同步原语和内存管理 支持抢占式多任务和协作式多任务 实现了实时调度器   硬件抽象层 (HAL)  提供统一的硬件访问接口 支持多种 CPU 架构和开发板   设备驱动框架  统一的驱动模型 支持动态加载和卸载驱动   网络协议栈  支持多种网络协议，如 TCP&#x2F;IP、Bluetooth、IEEE 802.15.4   文件系统  支持多种文件系统，如 FAT、LittleFS   电源管理  提供低功耗模式和动态频率调节   安全子系统  提供加密、认证和安全启动等功能    模块化设计Zephyr 采用高度模块化的设计，主要体现在：  内核模块化  核心功能和可选功能分离 通过 Kconfig...</div></div></div></a><a class="pagination-related" href="/2023/12/21/nodic/zephyr/README/" title="Zephyr RTOS 学习指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-21</div><div class="info-item-2">Zephyr RTOS 学习指南</div></div><div class="info-2"><div class="info-item-1">Zephyr RTOS 学习指南版本信息 版本：V1.0 更新时间：2025年03月20日 22:09  目录结构 快速入门  环境搭建 Hello World 示例 基本概念   系统架构  内核架构 硬件支持 设备树 驱动模型   核心模块  内核模块 线程管理 内存管理 中断处理 定时器   驱动系统 GPIO UART SPI I2C   网络协议栈 文件系统 电源管理   开发指南  应用开发流程 驱动开发指南 调试技巧 测试框架 贡献指南   示例代码  基础示例 网络示例 传感器示例 蓝牙示例   硬件支持  支持的开发板 添加新板子 硬件抽象层   工具链  West 工具 配置系统 构建系统 调试工具   常见问题  编译问题 运行问题 开发问题    文档说明本文档旨在帮助开发者快速上手 Zephyr RTOS，涵盖了从入门到进阶的完整学习路径。基于 Zephyr v2.9.1...</div></div></div></a><a class="pagination-related" href="/2025/03/20/nodic/zephyr/architecture/hardware/" title="Zephyr 硬件支持"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-20</div><div class="info-item-2">Zephyr 硬件支持</div></div><div class="info-2"><div class="info-item-1">Zephyr 硬件支持版本信息 版本：V1.0 更新时间：2025年03月20日 23:00  Zephyr RTOS 提供了广泛的硬件平台支持，包括多种 CPU 架构和开发板。本文档将详细介绍 Zephyr 的硬件支持架构。 支持的硬件架构ARM 架构 Cortex-M 系列  Cortex-M0&#x2F;M0+ Cortex-M3 Cortex-M4 Cortex-M7 Cortex-M23 Cortex-M33   Cortex-R 系列  Cortex-R5 Cortex-R7   Cortex-A 系列  Cortex-A53 Cortex-A72    x86 架构 Intel IA-32  Intel Quark Intel Atom   x86_64  支持现代 x86_64 处理器    RISC-V RV32  RV32I RV32IM RV32IMC RV32IMAC   RV64  RV64I RV64IM RV64IMAC    其他架构 Xtensa  ESP32 ESP32-S2 ESP32-S3   ARC  EM 系列 HS...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/%E7%BE%8E%E5%A5%B3.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">JoeNero</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">126</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">26</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/JoeForkYou"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/JoeForkYou" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:17549663745@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">wow!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Zephyr-Shell-%E5%91%BD%E4%BB%A4%E7%B3%BB%E7%BB%9F%E6%8C%87%E5%8D%97"><span class="toc-number">1.</span> <span class="toc-text">Zephyr Shell 命令系统指南</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Shell%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84"><span class="toc-number">1.1.</span> <span class="toc-text">1. Shell系统架构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 整体架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 基本配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%91%BD%E4%BB%A4%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.2.</span> <span class="toc-text">2. 命令实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 基本命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%AD%90%E5%91%BD%E4%BB%A4"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 子命令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%8F%82%E6%95%B0%E5%A4%84%E7%90%86"><span class="toc-number">1.3.</span> <span class="toc-text">3. 参数处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 参数解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%8F%82%E6%95%B0%E9%AA%8C%E8%AF%81"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 参数验证</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-number">1.4.</span> <span class="toc-text">4. 输出格式化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%9F%BA%E6%9C%AC%E8%BE%93%E5%87%BA"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 基本输出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E8%A1%A8%E6%A0%BC%E8%BE%93%E5%87%BA"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 表格输出</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%8A%A8%E6%80%81%E5%91%BD%E4%BB%A4"><span class="toc-number">1.5.</span> <span class="toc-text">5. 动态命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E8%BF%90%E8%A1%8C%E6%97%B6%E6%B3%A8%E5%86%8C"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 运行时注册</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E5%8A%A8%E6%80%81%E5%AD%90%E5%91%BD%E4%BB%A4"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 动态子命令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E8%87%AA%E5%AE%9A%E4%B9%89Shell%E5%90%8E%E7%AB%AF"><span class="toc-number">1.6.</span> <span class="toc-text">6. 自定义Shell后端</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E5%9F%BA%E6%9C%AC%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 基本实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E6%B3%A8%E5%86%8C%E8%87%AA%E5%AE%9A%E4%B9%89Shell"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 注册自定义Shell</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E9%AB%98%E7%BA%A7%E5%8A%9F%E8%83%BD"><span class="toc-number">1.7.</span> <span class="toc-text">7. 高级功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E5%91%BD%E4%BB%A4%E5%88%AB%E5%90%8D"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 命令别名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E5%91%BD%E4%BB%A4%E7%BB%84"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2 命令组</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.8.</span> <span class="toc-text">8. 实际应用示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7%E5%91%BD%E4%BB%A4"><span class="toc-number">1.8.1.</span> <span class="toc-text">8.1 系统监控命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E8%AE%BE%E5%A4%87%E6%8E%A7%E5%88%B6%E5%91%BD%E4%BB%A4"><span class="toc-number">1.8.2.</span> <span class="toc-text">8.2 设备控制命令</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/21/nodic/zephyr/core/drivers/" title="drivers">drivers</a><time datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/21/nodic/zephyr/core/filesystem/" title="filesystem">filesystem</a><time datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/21/nodic/zephyr/core/hardware/" title="hardware">hardware</a><time datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/21/nodic/zephyr/core/kernel/" title="kernel">kernel</a><time datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/21/nodic/zephyr/core/networking/" title="networking">networking</a><time datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By JoeNero</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.<p><a target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/lite/builds/browser.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div></div></body></html>