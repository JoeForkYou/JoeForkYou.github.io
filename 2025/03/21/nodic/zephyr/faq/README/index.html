<!DOCTYPE html><html lang="cn" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Zephyr RTOS 常见问题 | JoeNero的博客</title><meta name="author" content="JoeNero"><meta name="copyright" content="JoeNero"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Zephyr RTOS 常见问题本文档收集了 Zephyr RTOS 开发过程中的常见问题和解决方案，帮助开发者快速解决遇到的问题。 目录 编译问题 运行问题 开发问题 硬件问题 调试问题 性能问题 配置问题 工具链问题  1. 编译问题1.1 找不到 west 命令问题: 安装 Zephyr 后，执行 west 命令时提示 “command not found”。 解决方案:  确保已正确安装">
<meta property="og:type" content="article">
<meta property="og:title" content="Zephyr RTOS 常见问题">
<meta property="og:url" content="https://joeforkyou.github.io/2025/03/21/nodic/zephyr/faq/README/index.html">
<meta property="og:site_name" content="JoeNero的博客">
<meta property="og:description" content="Zephyr RTOS 常见问题本文档收集了 Zephyr RTOS 开发过程中的常见问题和解决方案，帮助开发者快速解决遇到的问题。 目录 编译问题 运行问题 开发问题 硬件问题 调试问题 性能问题 配置问题 工具链问题  1. 编译问题1.1 找不到 west 命令问题: 安装 Zephyr 后，执行 west 命令时提示 “command not found”。 解决方案:  确保已正确安装">
<meta property="og:locale">
<meta property="og:image" content="https://joeforkyou.github.io/img/%E7%BE%8E%E5%A5%B3.jpg">
<meta property="article:published_time" content="2025-03-21T12:49:56.000Z">
<meta property="article:modified_time" content="2025-03-21T14:16:26.260Z">
<meta property="article:author" content="JoeNero">
<meta property="article:tag" content="zephyr">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://joeforkyou.github.io/img/%E7%BE%8E%E5%A5%B3.jpg"><link rel="shortcut icon" href="/img/1.jpg"><link rel="canonical" href="https://joeforkyou.github.io/2025/03/21/nodic/zephyr/faq/README/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"IZ845G3SQG","apiKey":"381e98702820650923216a5f47f18d71","indexName":"movie","hitsPerPage":6,"languages":{"input_placeholder":"Search for Posts","hits_empty":"No results found for: ${query}","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Zephyr RTOS 常见问题',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="JoeNero的博客" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/%E7%BE%8E%E5%A5%B3.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">126</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">26</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-image"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">JoeNero的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">Zephyr RTOS 常见问题</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-image"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Zephyr RTOS 常见问题</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-03-21T14:16:26.260Z" title="Updated 2025-03-21 22:16:26">2025-03-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/zephyr/">zephyr</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Zephyr-RTOS-常见问题"><a href="#Zephyr-RTOS-常见问题" class="headerlink" title="Zephyr RTOS 常见问题"></a>Zephyr RTOS 常见问题</h1><p>本文档收集了 Zephyr RTOS 开发过程中的常见问题和解决方案，帮助开发者快速解决遇到的问题。</p>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ol>
<li><a href="#1-%E7%BC%96%E8%AF%91%E9%97%AE%E9%A2%98">编译问题</a></li>
<li><a href="#2-%E8%BF%90%E8%A1%8C%E9%97%AE%E9%A2%98">运行问题</a></li>
<li><a href="#3-%E5%BC%80%E5%8F%91%E9%97%AE%E9%A2%98">开发问题</a></li>
<li><a href="#4-%E7%A1%AC%E4%BB%B6%E9%97%AE%E9%A2%98">硬件问题</a></li>
<li><a href="#5-%E8%B0%83%E8%AF%95%E9%97%AE%E9%A2%98">调试问题</a></li>
<li><a href="#6-%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98">性能问题</a></li>
<li><a href="#7-%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%98">配置问题</a></li>
<li><a href="#8-%E5%B7%A5%E5%85%B7%E9%93%BE%E9%97%AE%E9%A2%98">工具链问题</a></li>
</ol>
<h2 id="1-编译问题"><a href="#1-编译问题" class="headerlink" title="1. 编译问题"></a>1. 编译问题</h2><h3 id="1-1-找不到-west-命令"><a href="#1-1-找不到-west-命令" class="headerlink" title="1.1 找不到 west 命令"></a>1.1 找不到 west 命令</h3><p><strong>问题</strong>: 安装 Zephyr 后，执行 west 命令时提示 “command not found”。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>确保已正确安装 west:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install --user -U west</span><br></pre></td></tr></table></figure>
</li>
<li><p>确保 west 在 PATH 中:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Linux/macOS</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=~/.local/bin:&quot;$PATH&quot;&#x27;</span> &gt;&gt; ~/.bashrc</span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows</span></span><br><span class="line"><span class="comment"># 检查 %USERPROFILE%\AppData\Roaming\Python\Python3x\Scripts 是否在 PATH 中</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-2-CMake-错误"><a href="#1-2-CMake-错误" class="headerlink" title="1.2 CMake 错误"></a>1.2 CMake 错误</h3><p><strong>问题</strong>: 编译时出现 CMake 相关错误。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>确保 CMake 版本正确:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmake --version</span><br><span class="line"><span class="comment"># 应该是 3.20.0 或更高版本</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>检查 CMakeLists.txt 文件:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 确保第一行包含</span></span><br><span class="line">cmake_minimum_required(VERSION 3.20.0)</span><br></pre></td></tr></table></figure>
</li>
<li><p>清理构建目录:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf build</span><br><span class="line">west build -p auto -b &lt;board_name&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-3-缺少依赖库"><a href="#1-3-缺少依赖库" class="headerlink" title="1.3 缺少依赖库"></a>1.3 缺少依赖库</h3><p><strong>问题</strong>: 编译时提示缺少某些库。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>安装 Zephyr 所需的依赖:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ubuntu</span></span><br><span class="line"><span class="built_in">sudo</span> apt install --no-install-recommends git cmake ninja-build gperf \</span><br><span class="line">  ccache dfu-util device-tree-compiler wget \</span><br><span class="line">  python3-dev python3-pip python3-setuptools python3-tk python3-wheel xz-utils file \</span><br><span class="line">  make gcc gcc-multilib g++-multilib libsdl2-dev</span><br><span class="line"></span><br><span class="line"><span class="comment"># macOS</span></span><br><span class="line">brew install cmake ninja gperf python3 ccache qemu dtc</span><br></pre></td></tr></table></figure>
</li>
<li><p>对于特定模块的依赖，检查相应的文档并安装所需库。</p>
</li>
</ol>
<h3 id="1-4-设备树编译错误"><a href="#1-4-设备树编译错误" class="headerlink" title="1.4 设备树编译错误"></a>1.4 设备树编译错误</h3><p><strong>问题</strong>: 设备树编译时出现语法错误。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查设备树语法:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dtc -I dts -O dts -o /dev/null &lt;your_overlay_file&gt;.overlay</span><br></pre></td></tr></table></figure>
</li>
<li><p>常见的设备树错误:</p>
<ul>
<li>缺少分号</li>
<li>括号不匹配</li>
<li>引用了不存在的节点</li>
<li>属性格式错误</li>
</ul>
</li>
<li><p>使用 west build 的详细输出查看更多信息:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">west build -p auto -b &lt;board_name&gt; -- -DCMAKE_VERBOSE_MAKEFILE=ON</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="2-运行问题"><a href="#2-运行问题" class="headerlink" title="2. 运行问题"></a>2. 运行问题</h2><h3 id="2-1-无法烧录固件"><a href="#2-1-无法烧录固件" class="headerlink" title="2.1 无法烧录固件"></a>2.1 无法烧录固件</h3><p><strong>问题</strong>: 使用 <code>west flash</code> 无法将固件烧录到设备。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查设备连接:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Linux</span></span><br><span class="line">lsusb</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows</span></span><br><span class="line"><span class="comment"># 检查设备管理器</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>检查权限:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Linux</span></span><br><span class="line"><span class="built_in">sudo</span> usermod -a -G dialout <span class="variable">$USER</span></span><br><span class="line"><span class="comment"># 注销并重新登录</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装设备特定的工具:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如，对于 STM32</span></span><br><span class="line">pip3 install --user -U pyocd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对于 Nordic</span></span><br><span class="line">pip3 install --user -U nrfutil</span><br></pre></td></tr></table></figure>
</li>
<li><p>尝试手动烧录:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 OpenOCD</span></span><br><span class="line">openocd -f board/&lt;your_board&gt;.cfg -c <span class="string">&quot;program build/zephyr/zephyr.elf verify reset exit&quot;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-2-设备不启动"><a href="#2-2-设备不启动" class="headerlink" title="2.2 设备不启动"></a>2.2 设备不启动</h3><p><strong>问题</strong>: 固件已烧录，但设备不启动或不工作。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查串口输出:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">minicom -D /dev/ttyUSB0 -b 115200</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">screen /dev/ttyUSB0 115200</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查引导加载程序:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果使用 MCUboot，检查 MCUboot 是否正确配置</span></span><br><span class="line">west flash --hex-file build/zephyr/zephyr.signed.hex</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查硬件连接:</p>
<ul>
<li>确保电源连接正确</li>
<li>检查晶振是否工作</li>
<li>检查复位电路</li>
</ul>
</li>
<li><p>尝试恢复出厂固件:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对于 Nordic 设备</span></span><br><span class="line">nrfjprog --recover</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="2-3-串口无输出"><a href="#2-3-串口无输出" class="headerlink" title="2.3 串口无输出"></a>2.3 串口无输出</h3><p><strong>问题</strong>: 设备运行，但串口没有输出。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查串口配置:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 在 prj.conf 中</span><br><span class="line">CONFIG_SERIAL=y</span><br><span class="line">CONFIG_CONSOLE=y</span><br><span class="line">CONFIG_UART_CONSOLE=y</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查波特率:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认为 115200，确保终端程序使用相同的波特率</span></span><br><span class="line">screen /dev/ttyUSB0 115200</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查硬件连接:</p>
<ul>
<li>TX&#x2F;RX 线是否正确连接</li>
<li>地线是否连接</li>
<li>电平转换是否正确（如 3.3V vs 5V）</li>
</ul>
</li>
<li><p>尝试其他串口工具:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如 PuTTY、minicom、screen、Tera Term 等</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="3-开发问题"><a href="#3-开发问题" class="headerlink" title="3. 开发问题"></a>3. 开发问题</h2><h3 id="3-1-线程优先级问题"><a href="#3-1-线程优先级问题" class="headerlink" title="3.1 线程优先级问题"></a>3.1 线程优先级问题</h3><p><strong>问题</strong>: 线程调度不符合预期。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查线程优先级:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数值越小，优先级越高</span></span><br><span class="line">K_THREAD_DEFINE(my_thread_id, STACK_SIZE, my_thread_entry,</span><br><span class="line">               <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, MY_PRIORITY, <span class="number">0</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查线程状态:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加调试代码</span></span><br><span class="line">k_thread_foreach(thread_info_print, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现回调函数</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">thread_info_print</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> k_thread *thread, <span class="type">void</span> *user_data)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> name[CONFIG_THREAD_MAX_NAME_LEN];</span><br><span class="line">    k_thread_state_str(thread, name, <span class="keyword">sizeof</span>(name));</span><br><span class="line">    printk(<span class="string">&quot;线程 %p 状态: %s\n&quot;</span>, thread, name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>考虑使用调度锁:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在关键部分禁用调度</span></span><br><span class="line">k_sched_lock();</span><br><span class="line"><span class="comment">// 关键代码</span></span><br><span class="line">k_sched_unlock();</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="3-2-内存泄漏"><a href="#3-2-内存泄漏" class="headerlink" title="3.2 内存泄漏"></a>3.2 内存泄漏</h3><p><strong>问题</strong>: 系统长时间运行后内存不足。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>启用堆监控:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 在 prj.conf 中</span><br><span class="line">CONFIG_HEAP_MEM_POOL_SIZE=16384</span><br><span class="line">CONFIG_HEAP_LISTENER=y</span><br></pre></td></tr></table></figure>
</li>
<li><p>实现堆监听器:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/kernel.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/sys/heap_listener.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">heap_listener</span> <span class="title">my_listener</span>;</span></span><br><span class="line"><span class="type">static</span> <span class="type">size_t</span> allocated = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">heap_alloc_cb</span><span class="params">(<span class="type">uintptr_t</span> heap_id, <span class="type">void</span> *mem, <span class="type">size_t</span> bytes)</span></span><br><span class="line">&#123;</span><br><span class="line">    allocated += bytes;</span><br><span class="line">    printk(<span class="string">&quot;已分配: %zu 字节, 地址: %p\n&quot;</span>, bytes, mem);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">heap_free_cb</span><span class="params">(<span class="type">uintptr_t</span> heap_id, <span class="type">void</span> *mem, <span class="type">size_t</span> bytes)</span></span><br><span class="line">&#123;</span><br><span class="line">    allocated -= bytes;</span><br><span class="line">    printk(<span class="string">&quot;已释放: %zu 字节, 地址: %p\n&quot;</span>, bytes, mem);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">init_heap_monitor</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    heap_listener_init(&amp;my_listener, heap_alloc_cb, heap_free_cb);</span><br><span class="line">    heap_listener_register(&amp;my_listener);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查内存分配模式:</p>
<ul>
<li>确保每次 <code>k_malloc</code> 都有对应的 <code>k_free</code></li>
<li>避免在循环中分配内存而不释放</li>
<li>考虑使用内存池或内存分片代替动态分配</li>
</ul>
</li>
</ol>
<h3 id="3-3-栈溢出"><a href="#3-3-栈溢出" class="headerlink" title="3.3 栈溢出"></a>3.3 栈溢出</h3><p><strong>问题</strong>: 系统崩溃，可能是由于栈溢出。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>增加栈大小:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> STACK_SIZE 2048  <span class="comment">// 增加栈大小</span></span></span><br><span class="line">K_THREAD_STACK_DEFINE(my_thread_stack, STACK_SIZE);</span><br></pre></td></tr></table></figure>
</li>
<li><p>启用栈监控:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 在 prj.conf 中</span><br><span class="line">CONFIG_INIT_STACKS=y</span><br><span class="line">CONFIG_THREAD_STACK_INFO=y</span><br><span class="line">CONFIG_THREAD_MONITOR=y</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查栈使用情况:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">size_t</span> unused = k_thread_stack_space_get(my_thread);</span><br><span class="line">printk(<span class="string">&quot;未使用的栈空间: %zu 字节\n&quot;</span>, unused);</span><br></pre></td></tr></table></figure>
</li>
<li><p>减少局部变量:</p>
<ul>
<li>避免在栈上分配大数组</li>
<li>考虑使用静态或动态分配的缓冲区</li>
<li>减少递归深度</li>
</ul>
</li>
</ol>
<h3 id="3-4-死锁"><a href="#3-4-死锁" class="headerlink" title="3.4 死锁"></a>3.4 死锁</h3><p><strong>问题</strong>: 系统卡住，可能是由于死锁。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>使用超时:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用超时而不是 K_FOREVER</span></span><br><span class="line">ret = k_mutex_lock(&amp;my_mutex, K_MSEC(<span class="number">1000</span>));</span><br><span class="line"><span class="keyword">if</span> (ret == -EAGAIN) &#123;</span><br><span class="line">    printk(<span class="string">&quot;获取互斥量超时\n&quot;</span>);</span><br><span class="line">    <span class="comment">// 执行恢复操作</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>遵循锁的顺序:</p>
<ul>
<li>始终按照相同的顺序获取多个锁</li>
<li>避免在持有锁时调用未知函数</li>
</ul>
</li>
<li><p>使用死锁检测:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 在 prj.conf 中</span><br><span class="line">CONFIG_MUTEX_DBG=y</span><br></pre></td></tr></table></figure>
</li>
<li><p>考虑使用其他同步原语:</p>
<ul>
<li>信号量</li>
<li>事件</li>
<li>消息队列</li>
</ul>
</li>
</ol>
<h2 id="4-硬件问题"><a href="#4-硬件问题" class="headerlink" title="4. 硬件问题"></a>4. 硬件问题</h2><h3 id="4-1-GPIO-配置问题"><a href="#4-1-GPIO-配置问题" class="headerlink" title="4.1 GPIO 配置问题"></a>4.1 GPIO 配置问题</h3><p><strong>问题</strong>: GPIO 引脚不工作。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查设备树配置:</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">&amp;gpio0</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">status</span> <span class="operator">=</span> <span class="string">&quot;okay&quot;</span><span class="punctuation">;</span></span><br><span class="line"><span class="punctuation">&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">/</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="title class_">leds</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">compatible</span> <span class="operator">=</span> <span class="string">&quot;gpio-leds&quot;</span><span class="punctuation">;</span></span><br><span class="line"><span class="symbol">        led0:</span> <span class="title class_">led_0</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">gpios</span> <span class="operator">=</span> <span class="params">&lt;<span class="variable">&amp;gpio0</span> <span class="number">13</span> GPIO_ACTIVE_LOW&gt;</span><span class="punctuation">;</span></span><br><span class="line">        <span class="punctuation">&#125;;</span></span><br><span class="line">    <span class="punctuation">&#125;;</span></span><br><span class="line"><span class="punctuation">&#125;;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>检查 GPIO 初始化代码:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">gpio_dt_spec</span> <span class="title">led</span> =</span> GPIO_DT_SPEC_GET(DT_ALIAS(led0), gpios);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!device_is_ready(led.port)) &#123;</span><br><span class="line">    printk(<span class="string">&quot;GPIO 设备未就绪\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ret = gpio_pin_configure_dt(&amp;led, GPIO_OUTPUT_ACTIVE);</span><br><span class="line"><span class="keyword">if</span> (ret &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    printk(<span class="string">&quot;GPIO 配置失败: %d\n&quot;</span>, ret);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查硬件连接:</p>
<ul>
<li>确保引脚连接正确</li>
<li>检查上拉&#x2F;下拉电阻</li>
<li>确保引脚未被其他功能占用</li>
</ul>
</li>
<li><p>使用示波器或逻辑分析仪检查信号。</p>
</li>
</ol>
<h3 id="4-2-I2C-SPI-通信问题"><a href="#4-2-I2C-SPI-通信问题" class="headerlink" title="4.2 I2C&#x2F;SPI 通信问题"></a>4.2 I2C&#x2F;SPI 通信问题</h3><p><strong>问题</strong>: 无法与 I2C 或 SPI 设备通信。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查设备树配置:</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">&amp;i2c0</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">status</span> <span class="operator">=</span> <span class="string">&quot;okay&quot;</span><span class="punctuation">;</span></span><br><span class="line">    <span class="attr">clock-frequency</span> <span class="operator">=</span> <span class="params">&lt;I2C_BITRATE_STANDARD&gt;</span><span class="punctuation">;</span></span><br><span class="line"><span class="punctuation">&#125;;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>检查总线初始化:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">device</span> *<span class="title">i2c_dev</span> =</span> DEVICE_DT_GET(DT_NODELABEL(i2c0));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!device_is_ready(i2c_dev)) &#123;</span><br><span class="line">    printk(<span class="string">&quot;I2C 设备未就绪\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查地址和寄存器:</p>
<ul>
<li>确认设备地址正确</li>
<li>确认寄存器地址正确</li>
<li>考虑字节序问题</li>
</ul>
</li>
<li><p>降低通信速度:</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">&amp;i2c0</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">status</span> <span class="operator">=</span> <span class="string">&quot;okay&quot;</span><span class="punctuation">;</span></span><br><span class="line">    <span class="attr">clock-frequency</span> <span class="operator">=</span> <span class="params">&lt;I2C_BITRATE_STANDARD&gt;</span><span class="punctuation">;</span>  <span class="comment">// 使用标准速度 (100kHz)</span></span><br><span class="line"><span class="punctuation">&#125;;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用逻辑分析仪检查总线信号。</p>
</li>
</ol>
<h3 id="4-3-中断问题"><a href="#4-3-中断问题" class="headerlink" title="4.3 中断问题"></a>4.3 中断问题</h3><p><strong>问题</strong>: 中断没有触发或处理不正确。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查中断配置:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置 GPIO 中断</span></span><br><span class="line">ret = gpio_pin_interrupt_configure_dt(&amp;button, GPIO_INT_EDGE_TO_ACTIVE);</span><br><span class="line"><span class="keyword">if</span> (ret &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    printk(<span class="string">&quot;中断配置失败: %d\n&quot;</span>, ret);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置回调</span></span><br><span class="line">gpio_init_callback(&amp;button_cb_data, button_pressed, BIT(button.pin));</span><br><span class="line">gpio_add_callback(button.port, &amp;button_cb_data);</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查中断优先级:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IRQ_CONNECT(MY_IRQ_NUM, MY_IRQ_PRIO, my_isr, <span class="literal">NULL</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>确保中断处理函数简短:</p>
<ul>
<li>避免在中断处理函数中执行长时间操作</li>
<li>考虑使用工作队列延迟处理</li>
</ul>
</li>
<li><p>检查硬件连接:</p>
<ul>
<li>确保中断引脚连接正确</li>
<li>检查上拉&#x2F;下拉电阻</li>
</ul>
</li>
</ol>
<h2 id="5-调试问题"><a href="#5-调试问题" class="headerlink" title="5. 调试问题"></a>5. 调试问题</h2><h3 id="5-1-无法启动调试会话"><a href="#5-1-无法启动调试会话" class="headerlink" title="5.1 无法启动调试会话"></a>5.1 无法启动调试会话</h3><p><strong>问题</strong>: 使用 <code>west debug</code> 无法启动调试会话。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查调试器连接:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对于 J-Link</span></span><br><span class="line">JLinkExe -device &lt;your_device&gt; -<span class="keyword">if</span> SWD</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对于 OpenOCD</span></span><br><span class="line">openocd -f board/&lt;your_board&gt;.cfg</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查调试器驱动:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 J-Link 驱动</span></span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line"><span class="comment"># 安装 OpenOCD</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>尝试手动启动 GDB:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arm-none-eabi-gdb build/zephyr/zephyr.elf -ex <span class="string">&quot;target remote localhost:3333&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>检查构建类型:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">west build -p auto -b &lt;board_name&gt; -- -DCMAKE_BUILD_TYPE=Debug</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="5-2-断点不起作用"><a href="#5-2-断点不起作用" class="headerlink" title="5.2 断点不起作用"></a>5.2 断点不起作用</h3><p><strong>问题</strong>: 设置的断点不触发。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查优化级别:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 在 prj.conf 中</span><br><span class="line">CONFIG_NO_OPTIMIZATIONS=y</span><br><span class="line">CONFIG_DEBUG_OPTIMIZATIONS=y</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查代码是否被优化掉:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 volatile 防止优化</span></span><br><span class="line"><span class="keyword">volatile</span> <span class="type">int</span> counter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或使用 __attribute__((noinline))</span></span><br><span class="line">__attribute__((noinline)) <span class="type">void</span> <span class="title function_">my_function</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查符号信息:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arm-none-eabi-objdump -t build/zephyr/zephyr.elf | grep my_function</span><br></pre></td></tr></table></figure>
</li>
<li><p>尝试使用硬件断点:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) hbreak my_function</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="5-3-无法查看变量值"><a href="#5-3-无法查看变量值" class="headerlink" title="5.3 无法查看变量值"></a>5.3 无法查看变量值</h3><p><strong>问题</strong>: 在调试时无法查看变量值。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查优化级别（同上）。</p>
</li>
<li><p>使用 volatile 关键字:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">volatile</span> <span class="type">int</span> my_var = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查变量作用域:</p>
<ul>
<li>确保在正确的作用域中查看变量</li>
<li>考虑将局部变量提升为全局或静态变量</li>
</ul>
</li>
<li><p>使用 GDB 打印命令:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print my_var</span><br><span class="line">(gdb) print/x my_var  # 以十六进制显示</span><br><span class="line">(gdb) print *my_struct  # 显示结构体内容</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加观察点:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) watch my_var</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="6-性能问题"><a href="#6-性能问题" class="headerlink" title="6. 性能问题"></a>6. 性能问题</h2><h3 id="6-1-系统响应慢"><a href="#6-1-系统响应慢" class="headerlink" title="6.1 系统响应慢"></a>6.1 系统响应慢</h3><p><strong>问题</strong>: 系统响应时间长，实时性差。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查线程优先级:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 确保实时关键线程具有高优先级（低数值）</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RT_PRIORITY 0  <span class="comment">// 最高优先级</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>减少中断禁用时间:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 最小化关键区域</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key = irq_lock();</span><br><span class="line"><span class="comment">// 尽量减少这里的代码</span></span><br><span class="line">irq_unlock(key);</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用性能分析工具:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 在 prj.conf 中</span><br><span class="line">CONFIG_TRACING=y</span><br><span class="line">CONFIG_SEGGER_SYSTEMVIEW=y</span><br></pre></td></tr></table></figure>
</li>
<li><p>优化内存访问:</p>
<ul>
<li>使用对齐的内存访问</li>
<li>减少缓存未命中</li>
<li>考虑使用 DMA</li>
</ul>
</li>
</ol>
<h3 id="6-2-功耗过高"><a href="#6-2-功耗过高" class="headerlink" title="6.2 功耗过高"></a>6.2 功耗过高</h3><p><strong>问题</strong>: 设备功耗高于预期。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>启用电源管理:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 在 prj.conf 中</span><br><span class="line">CONFIG_PM=y</span><br></pre></td></tr></table></figure>
</li>
<li><p>实现设备电源管理:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">my_device_pm_control</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> device *dev,</span></span><br><span class="line"><span class="params">                              <span class="keyword">enum</span> pm_device_action action)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">switch</span> (action) &#123;</span><br><span class="line">    <span class="keyword">case</span> PM_DEVICE_ACTION_RESUME:</span><br><span class="line">        <span class="comment">// 恢复设备</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> PM_DEVICE_ACTION_SUSPEND:</span><br><span class="line">        <span class="comment">// 挂起设备</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">return</span> -ENOTSUP;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">PM_DEVICE_DT_DEFINE(DT_NODELABEL(my_device), my_device_pm_control);</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用低功耗模式:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当没有工作要做时</span></span><br><span class="line">pm_system_suspend(k_ticks_to_ms_floor64(</span><br><span class="line">                 k_ticks_to_ns_floor64(k_uptime_ticks())));</span><br></pre></td></tr></table></figure>
</li>
<li><p>禁用未使用的外设:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在不需要时禁用外设</span></span><br><span class="line">pm_device_action_run(dev, PM_DEVICE_ACTION_SUSPEND);</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="6-3-内存使用过多"><a href="#6-3-内存使用过多" class="headerlink" title="6.3 内存使用过多"></a>6.3 内存使用过多</h3><p><strong>问题</strong>: 系统内存使用量高。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>减少静态分配:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 在 prj.conf 中</span><br><span class="line">CONFIG_MAIN_STACK_SIZE=1024  # 减小主线程栈</span><br><span class="line">CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=1024  # 减小工作队列栈</span><br></pre></td></tr></table></figure>
</li>
<li><p>优化缓冲区大小:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用适当大小的缓冲区</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BUFFER_SIZE 64  <span class="comment">// 而不是 1024</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用内存池而不是堆:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义内存池</span></span><br><span class="line">K_MEM_POOL_DEFINE(my_pool, <span class="number">16</span>, <span class="number">64</span>, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用内存池</span></span><br><span class="line"><span class="type">void</span> *ptr = k_mem_pool_alloc(&amp;my_pool, <span class="number">64</span>, K_NO_WAIT);</span><br></pre></td></tr></table></figure>
</li>
<li><p>共享缓冲区:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用共享缓冲区而不是每个操作都分配新的</span></span><br><span class="line"><span class="type">static</span> <span class="type">uint8_t</span> shared_buffer[<span class="number">256</span>];</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="7-配置问题"><a href="#7-配置问题" class="headerlink" title="7. 配置问题"></a>7. 配置问题</h2><h3 id="7-1-Kconfig-选项冲突"><a href="#7-1-Kconfig-选项冲突" class="headerlink" title="7.1 Kconfig 选项冲突"></a>7.1 Kconfig 选项冲突</h3><p><strong>问题</strong>: 配置选项之间存在冲突。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查依赖关系:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">west build -t guiconfig</span><br><span class="line"><span class="comment"># 使用图形界面检查选项依赖</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查看 Kconfig 文件:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep -r <span class="string">&quot;CONFIG_MY_OPTION&quot;</span> zephyr/</span><br><span class="line"><span class="comment"># 找到定义该选项的文件</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 <code>depends on</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">config MY_OPTION</span><br><span class="line">    bool &quot;My option&quot;</span><br><span class="line">    depends on !CONFLICTING_OPTION</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查默认值:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">config MY_OPTION</span><br><span class="line">    bool &quot;My option&quot;</span><br><span class="line">    default y if SOME_CONDITION</span><br><span class="line">    default n</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="7-2-设备树覆盖问题"><a href="#7-2-设备树覆盖问题" class="headerlink" title="7.2 设备树覆盖问题"></a>7.2 设备树覆盖问题</h3><p><strong>问题</strong>: 设备树覆盖不生效。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查覆盖文件位置:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 应该位于</span></span><br><span class="line">boards/&lt;board_name&gt;.overlay</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">app/boards/&lt;board_name&gt;.overlay</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查节点路径:</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 确保使用正确的路径</span></span><br><span class="line"><span class="variable">&amp;i2c0</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// 修改 i2c0 节点</span></span><br><span class="line"><span class="punctuation">&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 或使用绝对路径</span></span><br><span class="line"><span class="keyword">/soc/</span><span class="title class_">i2c@40003000</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// 修改 i2c 节点</span></span><br><span class="line"><span class="punctuation">&#125;;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>检查兼容性字符串:</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">my_device:</span> <span class="title class_">my-device@50</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">compatible</span> <span class="operator">=</span> <span class="string">&quot;vendor,my-device&quot;</span><span class="punctuation">;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"><span class="punctuation">&#125;;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>检查生成的设备树:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">west build -t devicetree_legacy</span><br><span class="line"><span class="comment"># 查看 build/zephyr/zephyr.dts</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="7-3-链接器错误"><a href="#7-3-链接器错误" class="headerlink" title="7.3 链接器错误"></a>7.3 链接器错误</h3><p><strong>问题</strong>: 链接时出现 “section overflow” 或 “region overflow” 错误。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查内存使用情况:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">west build -t ram_report</span><br><span class="line">west build -t rom_report</span><br></pre></td></tr></table></figure>
</li>
<li><p>增加内存区域大小:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 在 prj.conf 中</span><br><span class="line">CONFIG_SRAM_SIZE=&lt;size&gt;</span><br><span class="line">CONFIG_FLASH_SIZE=&lt;size&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建自定义链接器脚本:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 在 CMakeLists.txt 中</span><br><span class="line">zephyr_linker_sources(RAM_SECTIONS custom_sections.ld)</span><br></pre></td></tr></table></figure>
</li>
<li><p>优化代码大小:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 在 prj.conf 中</span><br><span class="line">CONFIG_SIZE_OPTIMIZATIONS=y</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="8-工具链问题"><a href="#8-工具链问题" class="headerlink" title="8. 工具链问题"></a>8. 工具链问题</h2><h3 id="8-1-工具链版本不兼容"><a href="#8-1-工具链版本不兼容" class="headerlink" title="8.1 工具链版本不兼容"></a>8.1 工具链版本不兼容</h3><p><strong>问题</strong>: 工具链版本与 Zephyr 不兼容。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>检查推荐的工具链版本:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">west manifest --resolve</span><br><span class="line"><span class="comment"># 查看 manifest 文件中的工具链版本</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装正确版本的 SDK:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载特定版本的 SDK</span></span><br><span class="line">wget https://github.com/zephyrproject-rtos/sdk-ng/releases/download/v0.13.2/zephyr-sdk-0.13.2-linux-x86_64-setup.run</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 SDK</span></span><br><span class="line"><span class="built_in">chmod</span> +x zephyr-sdk-0.13.2-linux-x86_64-setup.run</span><br><span class="line">./zephyr-sdk-0.13.2-linux-x86_64-setup.run</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置环境变量:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> ZEPHYR_TOOLCHAIN_VARIANT=zephyr</span><br><span class="line"><span class="built_in">export</span> ZEPHYR_SDK_INSTALL_DIR=/opt/zephyr-sdk-0.13.2</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 Docker 容器:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用官方 Docker 镜像</span></span><br><span class="line">docker pull zephyrprojectrtos/zephyr-build</span><br><span class="line">docker run -it -v /path/to/project:/workdir zephyrprojectrtos/zephyr-build</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="8-2-West-命令失败"><a href="#8-2-West-命令失败" class="headerlink" title="8.2 West 命令失败"></a>8.2 West 命令失败</h3><p><strong>问题</strong>: West 命令执行失败。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>更新 West:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install --user -U west</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查 West 配置:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">west config -l</span><br></pre></td></tr></table></figure>
</li>
<li><p>重新初始化 West 工作区:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">west init -m https://github.com/zephyrproject-rtos/zephyr --mr main</span><br><span class="line">west update</span><br></pre></td></tr></table></figure>
</li>
<li><p>清理构建目录:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf build</span><br><span class="line">west build -p auto -b &lt;board_name&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="8-3-Python-依赖问题"><a href="#8-3-Python-依赖问题" class="headerlink" title="8.3 Python 依赖问题"></a>8.3 Python 依赖问题</h3><p><strong>问题</strong>: 缺少 Python 依赖。</p>
<p><strong>解决方案</strong>:</p>
<ol>
<li><p>安装 Zephyr Python 依赖:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install --user -r zephyr/scripts/requirements.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建虚拟环境:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 -m venv zephyr-venv</span><br><span class="line"><span class="built_in">source</span> zephyr-venv/bin/activate</span><br><span class="line">pip install -r zephyr/scripts/requirements.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查 Python 版本:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 --version</span><br><span class="line"><span class="comment"># 应该是 3.6 或更高版本</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>解决特定依赖问题:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如，安装 pyelftools</span></span><br><span class="line">pip3 install --user pyelftools</span><br></pre></td></tr></table></figure></li>
</ol>
<p>这些是 Zephyr RTOS 开发中的一些常见问题和解决方案。如果您遇到其他问题，可以查阅 <a target="_blank" rel="noopener" href="https://docs.zephyrproject.org/">Zephyr 官方文档</a>、<a target="_blank" rel="noopener" href="https://github.com/zephyrproject-rtos/zephyr/issues">GitHub 问题跟踪器</a> 或 <a target="_blank" rel="noopener" href="https://lists.zephyrproject.org/g/devel">Zephyr 开发者邮件列表</a>。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://joeforkyou.github.io">JoeNero</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://joeforkyou.github.io/2025/03/21/nodic/zephyr/faq/README/">https://joeforkyou.github.io/2025/03/21/nodic/zephyr/faq/README/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/zephyr/">zephyr</a></div><div class="post-share"><div class="social-share" data-image="/img/%E7%BE%8E%E5%A5%B3.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/03/21/nodic/zephyr/examples/timer/" title="timer"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">timer</div></div><div class="info-2"><div class="info-item-1">Zephyr 定时器示例1. 定时器配置1.1 基础配置 (prj.conf)1234567891011121314# 基础配置CONFIG_PRINTK=yCONFIG_SERIAL=yCONFIG_UART_CONSOLE=y# 定时器配置CONFIG_TIMER=yCONFIG_TIMER_HAS_64BIT_CYCLE_COUNTER=y# 系统时钟配置CONFIG_SYS_CLOCK_TICKS_PER_SEC=1000# 定时器测试配置（可选）CONFIG_TIMER_RANDOM_GENERATOR=y  2. 基本定时器示例2.1 k_timer 示例123456789101112131415161718192021222324252627282930313233#include &lt;zephyr/kernel.h&gt;/* 定义定时器 */struct k_timer my_timer;/* 定时器回调函数 */void timer_expiry_function(struct k_timer *timer_id)&#123;   ...</div></div></div></a><a class="pagination-related" href="/2025/03/21/nodic/zephyr/filesystem/README/" title="Zephyr 文件系统指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Zephyr 文件系统指南</div></div><div class="info-2"><div class="info-item-1">Zephyr 文件系统指南1. 文件系统概述Zephyr RTOS 支持多种文件系统，包括但不限于：  LittleFS：适用于嵌入式系统的轻量级文件系统 FAT：广泛兼容的文件系统 NFFS：专为闪存设计的文件系统  2. 基础配置2.1 文件系统配置 (prj.conf)12345678910111213141516# 文件系统支持CONFIG_FILE_SYSTEM=y# LittleFS 支持CONFIG_FILE_SYSTEM_LITTLEFS=y# FAT 文件系统支持（可选）CONFIG_FAT_FILESYSTEM_ELM=y# Flash 驱动配置CONFIG_FLASH=yCONFIG_FLASH_MAP=yCONFIG_FLASH_PAGE_LAYOUT=y# 文件系统 Shell 命令（可选，用于调试）CONFIG_FILE_SYSTEM_SHELL=y  2.2 分区配置 (boards&#x2F;xxx.overlay)12345678910111213141516171819202122232425262728/ &#123;    fstab...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/03/20/zephyer/zephyer1/" title="【Zephyr】【一】Zephyr RTOS 示例代码集"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-20</div><div class="info-item-2">【Zephyr】【一】Zephyr RTOS 示例代码集</div></div><div class="info-2"><div class="info-item-1">Zephyr RTOS 示例代码集1. 基础示例1.0 基础配置每个示例都需要一个 prj.conf 文件来配置项目。以下是各个示例所需的配置： 基础示例 prj.conf1234567891011# 控制台输出CONFIG_PRINTK=yCONFIG_SERIAL=yCONFIG_UART_CONSOLE=y# 日志系统CONFIG_LOG=yCONFIG_LOG_DEFAULT_LEVEL=3# 内核配置CONFIG_KERNEL_BIN_NAME=&quot;app&quot;  线程示例 prj.conf123456789# 基础配置CONFIG_PRINTK=yCONFIG_SERIAL=yCONFIG_UART_CONSOLE=y# 线程配置CONFIG_THREAD_NAME=yCONFIG_THREAD_MONITOR=yCONFIG_THREAD_STACK_INFO=y  1.1 Hello...</div></div></div></a><a class="pagination-related" href="/2025/03/20/zephyer/zephyr2/" title="【Zephyr】【二】Zephyr RTOS 系统架构"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-20</div><div class="info-item-2">【Zephyr】【二】Zephyr RTOS 系统架构</div></div><div class="info-2"><div class="info-item-1"> mermaid.initialize({startOnLoad:true});  Zephyr RTOS 系统架构整体架构 graph TB     subgraph "应用层"         App1[应用1]         App2[应用2]         App3[应用3]     end     subgraph "系统服务层"         FS[文件系统]         Net[网络协议栈]         Shell[命令行界面]     end     subgraph "内核层"         Sched[调度器]         Mem[内存管理]         IPC[进程间通信]         Time[时间管理]     end     subgraph "硬件抽象层"         GPIO[GPIO驱动]         UART[串口驱动]         SPI[SPI驱动]         I2C[I2C驱动]     end     App1 & App2 & App3 --> FS & Net & Shell    ...</div></div></div></a><a class="pagination-related" href="/2023/12/21/nodic/zephyr/architecture/devicetree/" title="Zephyr 设备树"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-21</div><div class="info-item-2">Zephyr 设备树</div></div><div class="info-2"><div class="info-item-1">Zephyr 设备树版本信息 版本：V1.0 更新时间：2025年03月20日 23:15  设备树（Device Tree）是 Zephyr RTOS 用于描述硬件配置的机制。它提供了一种统一的方式来描述系统硬件，使得硬件配置与软件代码分离，提高了代码的可移植性和可维护性。 设备树概述什么是设备树设备树是一种描述硬件的数据结构，它以树形结构表示硬件设备及其属性。在 Zephyr 中，设备树用于：  描述硬件配置 生成设备驱动的初始化代码 配置中断和引脚复用 定义内存映射  设备树的优势 硬件描述与软件分离：便于硬件配置的修改和维护 跨平台兼容性：同一套代码可以适用于不同的硬件平台 动态配置：支持运行时修改设备配置 标准化：采用行业标准的描述方式，提高可读性和互操作性  设备树语法基本结构设备树文件（.dts）的基本结构如下： 123456789101112131415161718/dts-v1/;/ &#123;    model = &quot;Example Board&quot;;    compatible = &quot;example,board&quot;;  ...</div></div></div></a><a class="pagination-related" href="/2025/03/20/nodic/zephyr/architecture/README/" title="Zephyr RTOS 系统架构"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-20</div><div class="info-item-2">Zephyr RTOS 系统架构</div></div><div class="info-2"><div class="info-item-1">Zephyr RTOS 系统架构版本信息 版本：V1.0 更新时间：2025年03月20日 22:30  Zephyr RTOS 是一个模块化、可扩展的实时操作系统，设计用于资源受限的嵌入式系统。本章节将介绍 Zephyr 的整体系统架构。 目录 内核架构 硬件支持 设备树 驱动模型  架构概览Zephyr 的系统架构主要包括以下几个部分：  微内核  提供基本的线程管理、同步原语和内存管理 支持抢占式多任务和协作式多任务 实现了实时调度器   硬件抽象层 (HAL)  提供统一的硬件访问接口 支持多种 CPU 架构和开发板   设备驱动框架  统一的驱动模型 支持动态加载和卸载驱动   网络协议栈  支持多种网络协议，如 TCP&#x2F;IP、Bluetooth、IEEE 802.15.4   文件系统  支持多种文件系统，如 FAT、LittleFS   电源管理  提供低功耗模式和动态频率调节   安全子系统  提供加密、认证和安全启动等功能    模块化设计Zephyr 采用高度模块化的设计，主要体现在：  内核模块化  核心功能和可选功能分离 通过 Kconfig...</div></div></div></a><a class="pagination-related" href="/2023/12/21/nodic/zephyr/README/" title="Zephyr RTOS 学习指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-21</div><div class="info-item-2">Zephyr RTOS 学习指南</div></div><div class="info-2"><div class="info-item-1">Zephyr RTOS 学习指南版本信息 版本：V1.0 更新时间：2025年03月20日 22:09  目录结构 快速入门  环境搭建 Hello World 示例 基本概念   系统架构  内核架构 硬件支持 设备树 驱动模型   核心模块  内核模块 线程管理 内存管理 中断处理 定时器   驱动系统 GPIO UART SPI I2C   网络协议栈 文件系统 电源管理   开发指南  应用开发流程 驱动开发指南 调试技巧 测试框架 贡献指南   示例代码  基础示例 网络示例 传感器示例 蓝牙示例   硬件支持  支持的开发板 添加新板子 硬件抽象层   工具链  West 工具 配置系统 构建系统 调试工具   常见问题  编译问题 运行问题 开发问题    文档说明本文档旨在帮助开发者快速上手 Zephyr RTOS，涵盖了从入门到进阶的完整学习路径。基于 Zephyr v2.9.1...</div></div></div></a><a class="pagination-related" href="/2025/03/20/nodic/zephyr/architecture/hardware/" title="Zephyr 硬件支持"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-20</div><div class="info-item-2">Zephyr 硬件支持</div></div><div class="info-2"><div class="info-item-1">Zephyr 硬件支持版本信息 版本：V1.0 更新时间：2025年03月20日 23:00  Zephyr RTOS 提供了广泛的硬件平台支持，包括多种 CPU 架构和开发板。本文档将详细介绍 Zephyr 的硬件支持架构。 支持的硬件架构ARM 架构 Cortex-M 系列  Cortex-M0&#x2F;M0+ Cortex-M3 Cortex-M4 Cortex-M7 Cortex-M23 Cortex-M33   Cortex-R 系列  Cortex-R5 Cortex-R7   Cortex-A 系列  Cortex-A53 Cortex-A72    x86 架构 Intel IA-32  Intel Quark Intel Atom   x86_64  支持现代 x86_64 处理器    RISC-V RV32  RV32I RV32IM RV32IMC RV32IMAC   RV64  RV64I RV64IM RV64IMAC    其他架构 Xtensa  ESP32 ESP32-S2 ESP32-S3   ARC  EM 系列 HS...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/%E7%BE%8E%E5%A5%B3.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">JoeNero</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">126</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">26</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/JoeForkYou"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/JoeForkYou" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:17549663745@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">wow!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Zephyr-RTOS-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="toc-number">1.</span> <span class="toc-text">Zephyr RTOS 常见问题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95"><span class="toc-number">1.1.</span> <span class="toc-text">目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%BC%96%E8%AF%91%E9%97%AE%E9%A2%98"><span class="toc-number">1.2.</span> <span class="toc-text">1. 编译问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%89%BE%E4%B8%8D%E5%88%B0-west-%E5%91%BD%E4%BB%A4"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.1 找不到 west 命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-CMake-%E9%94%99%E8%AF%AF"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2 CMake 错误</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E7%BC%BA%E5%B0%91%E4%BE%9D%E8%B5%96%E5%BA%93"><span class="toc-number">1.2.3.</span> <span class="toc-text">1.3 缺少依赖库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E8%AE%BE%E5%A4%87%E6%A0%91%E7%BC%96%E8%AF%91%E9%94%99%E8%AF%AF"><span class="toc-number">1.2.4.</span> <span class="toc-text">1.4 设备树编译错误</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%BF%90%E8%A1%8C%E9%97%AE%E9%A2%98"><span class="toc-number">1.3.</span> <span class="toc-text">2. 运行问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%97%A0%E6%B3%95%E7%83%A7%E5%BD%95%E5%9B%BA%E4%BB%B6"><span class="toc-number">1.3.1.</span> <span class="toc-text">2.1 无法烧录固件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E8%AE%BE%E5%A4%87%E4%B8%8D%E5%90%AF%E5%8A%A8"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.2 设备不启动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E4%B8%B2%E5%8F%A3%E6%97%A0%E8%BE%93%E5%87%BA"><span class="toc-number">1.3.3.</span> <span class="toc-text">2.3 串口无输出</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%BC%80%E5%8F%91%E9%97%AE%E9%A2%98"><span class="toc-number">1.4.</span> <span class="toc-text">3. 开发问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E7%BA%BF%E7%A8%8B%E4%BC%98%E5%85%88%E7%BA%A7%E9%97%AE%E9%A2%98"><span class="toc-number">1.4.1.</span> <span class="toc-text">3.1 线程优先级问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F"><span class="toc-number">1.4.2.</span> <span class="toc-text">3.2 内存泄漏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E6%A0%88%E6%BA%A2%E5%87%BA"><span class="toc-number">1.4.3.</span> <span class="toc-text">3.3 栈溢出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E6%AD%BB%E9%94%81"><span class="toc-number">1.4.4.</span> <span class="toc-text">3.4 死锁</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E7%A1%AC%E4%BB%B6%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.</span> <span class="toc-text">4. 硬件问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-GPIO-%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.1.</span> <span class="toc-text">4.1 GPIO 配置问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-I2C-SPI-%E9%80%9A%E4%BF%A1%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.2.</span> <span class="toc-text">4.2 I2C&#x2F;SPI 通信问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E4%B8%AD%E6%96%AD%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.3.</span> <span class="toc-text">4.3 中断问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E8%B0%83%E8%AF%95%E9%97%AE%E9%A2%98"><span class="toc-number">1.6.</span> <span class="toc-text">5. 调试问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E8%B0%83%E8%AF%95%E4%BC%9A%E8%AF%9D"><span class="toc-number">1.6.1.</span> <span class="toc-text">5.1 无法启动调试会话</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E6%96%AD%E7%82%B9%E4%B8%8D%E8%B5%B7%E4%BD%9C%E7%94%A8"><span class="toc-number">1.6.2.</span> <span class="toc-text">5.2 断点不起作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E6%97%A0%E6%B3%95%E6%9F%A5%E7%9C%8B%E5%8F%98%E9%87%8F%E5%80%BC"><span class="toc-number">1.6.3.</span> <span class="toc-text">5.3 无法查看变量值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98"><span class="toc-number">1.7.</span> <span class="toc-text">6. 性能问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E7%B3%BB%E7%BB%9F%E5%93%8D%E5%BA%94%E6%85%A2"><span class="toc-number">1.7.1.</span> <span class="toc-text">6.1 系统响应慢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%8A%9F%E8%80%97%E8%BF%87%E9%AB%98"><span class="toc-number">1.7.2.</span> <span class="toc-text">6.2 功耗过高</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8%E8%BF%87%E5%A4%9A"><span class="toc-number">1.7.3.</span> <span class="toc-text">6.3 内存使用过多</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%98"><span class="toc-number">1.8.</span> <span class="toc-text">7. 配置问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-Kconfig-%E9%80%89%E9%A1%B9%E5%86%B2%E7%AA%81"><span class="toc-number">1.8.1.</span> <span class="toc-text">7.1 Kconfig 选项冲突</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E8%AE%BE%E5%A4%87%E6%A0%91%E8%A6%86%E7%9B%96%E9%97%AE%E9%A2%98"><span class="toc-number">1.8.2.</span> <span class="toc-text">7.2 设备树覆盖问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E9%93%BE%E6%8E%A5%E5%99%A8%E9%94%99%E8%AF%AF"><span class="toc-number">1.8.3.</span> <span class="toc-text">7.3 链接器错误</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%B7%A5%E5%85%B7%E9%93%BE%E9%97%AE%E9%A2%98"><span class="toc-number">1.9.</span> <span class="toc-text">8. 工具链问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E5%B7%A5%E5%85%B7%E9%93%BE%E7%89%88%E6%9C%AC%E4%B8%8D%E5%85%BC%E5%AE%B9"><span class="toc-number">1.9.1.</span> <span class="toc-text">8.1 工具链版本不兼容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-West-%E5%91%BD%E4%BB%A4%E5%A4%B1%E8%B4%A5"><span class="toc-number">1.9.2.</span> <span class="toc-text">8.2 West 命令失败</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-Python-%E4%BE%9D%E8%B5%96%E9%97%AE%E9%A2%98"><span class="toc-number">1.9.3.</span> <span class="toc-text">8.3 Python 依赖问题</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/21/nodic/zephyr/core/drivers/" title="drivers">drivers</a><time datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/21/nodic/zephyr/core/filesystem/" title="filesystem">filesystem</a><time datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/21/nodic/zephyr/core/hardware/" title="hardware">hardware</a><time datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/21/nodic/zephyr/core/kernel/" title="kernel">kernel</a><time datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/21/nodic/zephyr/core/networking/" title="networking">networking</a><time datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By JoeNero</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.<p><a target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/lite/builds/browser.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div></div></body></html>