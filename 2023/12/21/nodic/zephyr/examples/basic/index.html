<!DOCTYPE html><html lang="cn" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Zephyr 基础示例 | JoeNero的博客</title><meta name="author" content="JoeNero"><meta name="copyright" content="JoeNero"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Zephyr 基础示例本文档提供了 Zephyr RTOS 的基础示例代码，包括 Hello World、LED 控制、按键输入、定时器使用和多线程编程等内容。这些示例适合初学者快速上手 Zephyr 开发。 Hello World这是最基本的 Zephyr 应用程序，展示了如何创建一个简单的 Zephyr 项目并输出 “Hello World” 消息。 源代码src&#x2F;main.c: 1">
<meta property="og:type" content="article">
<meta property="og:title" content="Zephyr 基础示例">
<meta property="og:url" content="https://joeforkyou.github.io/2023/12/21/nodic/zephyr/examples/basic/index.html">
<meta property="og:site_name" content="JoeNero的博客">
<meta property="og:description" content="Zephyr 基础示例本文档提供了 Zephyr RTOS 的基础示例代码，包括 Hello World、LED 控制、按键输入、定时器使用和多线程编程等内容。这些示例适合初学者快速上手 Zephyr 开发。 Hello World这是最基本的 Zephyr 应用程序，展示了如何创建一个简单的 Zephyr 项目并输出 “Hello World” 消息。 源代码src&#x2F;main.c: 1">
<meta property="og:locale">
<meta property="og:image" content="https://joeforkyou.github.io/img/%E7%BE%8E%E5%A5%B3.jpg">
<meta property="article:published_time" content="2023-12-21T02:00:00.000Z">
<meta property="article:modified_time" content="2025-03-21T13:40:45.332Z">
<meta property="article:author" content="JoeNero">
<meta property="article:tag" content="zephyr">
<meta property="article:tag" content="embedded">
<meta property="article:tag" content="examples">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://joeforkyou.github.io/img/%E7%BE%8E%E5%A5%B3.jpg"><link rel="shortcut icon" href="/img/1.jpg"><link rel="canonical" href="https://joeforkyou.github.io/2023/12/21/nodic/zephyr/examples/basic/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"IZ845G3SQG","apiKey":"381e98702820650923216a5f47f18d71","indexName":"movie","hitsPerPage":6,"languages":{"input_placeholder":"Search for Posts","hits_empty":"No results found for: ${query}","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Zephyr 基础示例',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="JoeNero的博客" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/%E7%BE%8E%E5%A5%B3.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">128</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">27</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-image"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">JoeNero的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">Zephyr 基础示例</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-image"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Zephyr 基础示例</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-12-21T02:00:00.000Z" title="Created 2023-12-21 10:00:00">2023-12-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-03-21T13:40:45.332Z" title="Updated 2025-03-21 21:40:45">2025-03-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/nodic/">nodic</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/nodic/zephyr/">zephyr</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/nodic/zephyr/examples/">examples</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Zephyr-基础示例"><a href="#Zephyr-基础示例" class="headerlink" title="Zephyr 基础示例"></a>Zephyr 基础示例</h1><p>本文档提供了 Zephyr RTOS 的基础示例代码，包括 Hello World、LED 控制、按键输入、定时器使用和多线程编程等内容。这些示例适合初学者快速上手 Zephyr 开发。</p>
<h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><p>这是最基本的 Zephyr 应用程序，展示了如何创建一个简单的 Zephyr 项目并输出 “Hello World” 消息。</p>
<h3 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h3><p><strong>src&#x2F;main.c</strong>:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Copyright (c) 2023 Your Name</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * SPDX-License-Identifier: Apache-2.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/kernel.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/sys/printk.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    printk(<span class="string">&quot;Hello World! %s\n&quot;</span>, CONFIG_BOARD);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>prj.conf</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 空配置文件，Hello World 不需要特殊配置</span><br></pre></td></tr></table></figure>

<h3 id="构建和运行"><a href="#构建和运行" class="headerlink" title="构建和运行"></a>构建和运行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">west build -b qemu_x86 samples/hello_world</span><br><span class="line">west run</span><br></pre></td></tr></table></figure>

<h3 id="输出结果"><a href="#输出结果" class="headerlink" title="输出结果"></a>输出结果</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello World! qemu_x86</span><br></pre></td></tr></table></figure>

<h3 id="代码说明"><a href="#代码说明" class="headerlink" title="代码说明"></a>代码说明</h3><ol>
<li><code>#include &lt;zephyr/kernel.h&gt;</code> - 包含 Zephyr 内核头文件</li>
<li><code>#include &lt;zephyr/sys/printk.h&gt;</code> - 包含打印函数头文件</li>
<li><code>printk()</code> - 输出字符串到控制台</li>
<li><code>CONFIG_BOARD</code> - 预定义宏，表示当前的开发板名称</li>
</ol>
<h2 id="LED-控制"><a href="#LED-控制" class="headerlink" title="LED 控制"></a>LED 控制</h2><p>这个示例展示了如何控制开发板上的 LED，实现 LED 闪烁功能。</p>
<h3 id="源代码-1"><a href="#源代码-1" class="headerlink" title="源代码"></a>源代码</h3><p><strong>src&#x2F;main.c</strong>:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Copyright (c) 2023 Your Name</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * SPDX-License-Identifier: Apache-2.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/kernel.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/drivers/gpio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* LED 设备树别名 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED0_NODE DT_ALIAS(led0)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> DT_NODE_HAS_STATUS(LED0_NODE, okay)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED0 DT_GPIO_CTLR(LED0_NODE, gpios)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED0_PIN DT_GPIO_PIN(LED0_NODE, gpios)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED0_FLAGS DT_GPIO_FLAGS(LED0_NODE, gpios)</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="comment">/* 如果设备树中没有定义 LED，使用默认值 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED0 DT_NODELABEL(gpio0)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED0_PIN 13</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED0_FLAGS 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">device</span> *<span class="title">dev</span>;</span></span><br><span class="line">    <span class="type">bool</span> led_state = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">int</span> ret;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 获取 GPIO 设备 */</span></span><br><span class="line">    dev = DEVICE_DT_GET(LED0);</span><br><span class="line">    <span class="keyword">if</span> (!device_is_ready(dev)) &#123;</span><br><span class="line">        printk(<span class="string">&quot;Error: %s device not ready\n&quot;</span>, dev-&gt;name);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 配置 LED 引脚为输出 */</span></span><br><span class="line">    ret = gpio_pin_configure(dev, LED0_PIN, GPIO_OUTPUT | LED0_FLAGS);</span><br><span class="line">    <span class="keyword">if</span> (ret &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        printk(<span class="string">&quot;Error %d: failed to configure pin %d\n&quot;</span>, ret, LED0_PIN);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    printk(<span class="string">&quot;LED control example started\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 循环闪烁 LED */</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">/* 切换 LED 状态 */</span></span><br><span class="line">        led_state = !led_state;</span><br><span class="line">        gpio_pin_set(dev, LED0_PIN, led_state);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 延时 1 秒 */</span></span><br><span class="line">        k_sleep(K_MSEC(<span class="number">1000</span>));</span><br><span class="line">        </span><br><span class="line">        printk(<span class="string">&quot;LED state: %s\n&quot;</span>, led_state ? <span class="string">&quot;ON&quot;</span> : <span class="string">&quot;OFF&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>prj.conf</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONFIG_GPIO=y</span><br></pre></td></tr></table></figure>

<h3 id="构建和运行-1"><a href="#构建和运行-1" class="headerlink" title="构建和运行"></a>构建和运行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">west build -b &lt;board&gt; samples/basic/blinky</span><br><span class="line">west flash</span><br></pre></td></tr></table></figure>

<h3 id="代码说明-1"><a href="#代码说明-1" class="headerlink" title="代码说明"></a>代码说明</h3><ol>
<li><code>#include &lt;zephyr/drivers/gpio.h&gt;</code> - 包含 GPIO 驱动头文件</li>
<li><code>DT_ALIAS(led0)</code> - 获取设备树中 LED 的别名</li>
<li><code>DEVICE_DT_GET()</code> - 获取设备实例</li>
<li><code>device_is_ready()</code> - 检查设备是否准备就绪</li>
<li><code>gpio_pin_configure()</code> - 配置 GPIO 引脚</li>
<li><code>gpio_pin_set()</code> - 设置 GPIO 引脚状态</li>
<li><code>k_sleep()</code> - 延时函数</li>
</ol>
<h2 id="按键输入"><a href="#按键输入" class="headerlink" title="按键输入"></a>按键输入</h2><p>这个示例展示了如何读取按键输入并响应按键事件。</p>
<h3 id="源代码-2"><a href="#源代码-2" class="headerlink" title="源代码"></a>源代码</h3><p><strong>src&#x2F;main.c</strong>:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Copyright (c) 2023 Your Name</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * SPDX-License-Identifier: Apache-2.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/kernel.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/drivers/gpio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/sys/printk.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 按键设备树别名 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BUTTON_NODE DT_ALIAS(sw0)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> DT_NODE_HAS_STATUS(BUTTON_NODE, okay)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BUTTON_GPIO_LABEL DT_GPIO_CTLR(BUTTON_NODE, gpios)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BUTTON_PIN DT_GPIO_PIN(BUTTON_NODE, gpios)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BUTTON_FLAGS DT_GPIO_FLAGS(BUTTON_NODE, gpios)</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="comment">/* 如果设备树中没有定义按键，使用默认值 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BUTTON_GPIO_LABEL DT_NODELABEL(gpio0)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BUTTON_PIN 11</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BUTTON_FLAGS (GPIO_INPUT | GPIO_PULL_UP)</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* LED 设备树别名 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED_NODE DT_ALIAS(led0)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> DT_NODE_HAS_STATUS(LED_NODE, okay)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED_GPIO_LABEL DT_GPIO_CTLR(LED_NODE, gpios)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED_PIN DT_GPIO_PIN(LED_NODE, gpios)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED_FLAGS DT_GPIO_FLAGS(LED_NODE, gpios)</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="comment">/* 如果设备树中没有定义 LED，使用默认值 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED_GPIO_LABEL DT_NODELABEL(gpio0)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED_PIN 13</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED_FLAGS 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 按键中断回调函数 */</span></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">gpio_callback</span> <span class="title">button_cb_data</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">button_pressed</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> device *dev, <span class="keyword">struct</span> gpio_callback *cb,</span></span><br><span class="line"><span class="params">                    <span class="type">uint32_t</span> pins)</span></span><br><span class="line">&#123;</span><br><span class="line">    printk(<span class="string">&quot;Button pressed at %&quot;</span> PRIu32 <span class="string">&quot;\n&quot;</span>, k_cycle_get_32());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">device</span> *<span class="title">button_dev</span>, *<span class="title">led_dev</span>;</span></span><br><span class="line">    <span class="type">int</span> ret;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 获取 GPIO 设备 */</span></span><br><span class="line">    button_dev = DEVICE_DT_GET(BUTTON_GPIO_LABEL);</span><br><span class="line">    <span class="keyword">if</span> (!device_is_ready(button_dev)) &#123;</span><br><span class="line">        printk(<span class="string">&quot;Error: button device %s is not ready\n&quot;</span>, button_dev-&gt;name);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    led_dev = DEVICE_DT_GET(LED_GPIO_LABEL);</span><br><span class="line">    <span class="keyword">if</span> (!device_is_ready(led_dev)) &#123;</span><br><span class="line">        printk(<span class="string">&quot;Error: LED device %s is not ready\n&quot;</span>, led_dev-&gt;name);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 配置按键引脚 */</span></span><br><span class="line">    ret = gpio_pin_configure(button_dev, BUTTON_PIN, GPIO_INPUT | BUTTON_FLAGS);</span><br><span class="line">    <span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">        printk(<span class="string">&quot;Error %d: failed to configure button pin %d\n&quot;</span>,</span><br><span class="line">               ret, BUTTON_PIN);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 配置 LED 引脚 */</span></span><br><span class="line">    ret = gpio_pin_configure(led_dev, LED_PIN, GPIO_OUTPUT | LED_FLAGS);</span><br><span class="line">    <span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">        printk(<span class="string">&quot;Error %d: failed to configure LED pin %d\n&quot;</span>,</span><br><span class="line">               ret, LED_PIN);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 配置按键中断 */</span></span><br><span class="line">    ret = gpio_pin_interrupt_configure(button_dev, BUTTON_PIN,</span><br><span class="line">                                      GPIO_INT_EDGE_TO_ACTIVE);</span><br><span class="line">    <span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">        printk(<span class="string">&quot;Error %d: failed to configure button interrupt\n&quot;</span>, ret);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 设置中断回调 */</span></span><br><span class="line">    gpio_init_callback(&amp;button_cb_data, button_pressed, BIT(BUTTON_PIN));</span><br><span class="line">    gpio_add_callback(button_dev, &amp;button_cb_data);</span><br><span class="line"></span><br><span class="line">    printk(<span class="string">&quot;Button example started\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 主循环 */</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">/* 读取按键状态 */</span></span><br><span class="line">        <span class="type">int</span> val = gpio_pin_get(button_dev, BUTTON_PIN);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 设置 LED 状态与按键状态相反（按下时点亮） */</span></span><br><span class="line">        gpio_pin_set(led_dev, LED_PIN, val == <span class="number">0</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 延时 100 毫秒 */</span></span><br><span class="line">        k_sleep(K_MSEC(<span class="number">100</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>prj.conf</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONFIG_GPIO=y</span><br></pre></td></tr></table></figure>

<h3 id="构建和运行-2"><a href="#构建和运行-2" class="headerlink" title="构建和运行"></a>构建和运行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">west build -b &lt;board&gt; samples/basic/button</span><br><span class="line">west flash</span><br></pre></td></tr></table></figure>

<h3 id="代码说明-2"><a href="#代码说明-2" class="headerlink" title="代码说明"></a>代码说明</h3><ol>
<li><code>gpio_pin_interrupt_configure()</code> - 配置 GPIO 中断</li>
<li><code>gpio_init_callback()</code> - 初始化中断回调</li>
<li><code>gpio_add_callback()</code> - 添加中断回调</li>
<li><code>gpio_pin_get()</code> - 获取 GPIO 引脚状态</li>
<li><code>k_cycle_get_32()</code> - 获取系统时钟周期计数</li>
</ol>
<h2 id="定时器使用"><a href="#定时器使用" class="headerlink" title="定时器使用"></a>定时器使用</h2><p>这个示例展示了如何使用 Zephyr 的定时器功能。</p>
<h3 id="源代码-3"><a href="#源代码-3" class="headerlink" title="源代码"></a>源代码</h3><p><strong>src&#x2F;main.c</strong>:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Copyright (c) 2023 Your Name</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * SPDX-License-Identifier: Apache-2.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/kernel.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/sys/printk.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定时器回调函数 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">timer_handler</span><span class="params">(<span class="keyword">struct</span> k_timer *timer)</span></span><br><span class="line">&#123;</span><br><span class="line">    printk(<span class="string">&quot;Timer expired at %d ms\n&quot;</span>, k_uptime_get_32());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定时器停止回调函数 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">timer_stop_handler</span><span class="params">(<span class="keyword">struct</span> k_timer *timer)</span></span><br><span class="line">&#123;</span><br><span class="line">    printk(<span class="string">&quot;Timer stopped\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义定时器 */</span></span><br><span class="line">K_TIMER_DEFINE(my_timer, timer_handler, timer_stop_handler);</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    printk(<span class="string">&quot;Timer example started\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 启动定时器：2秒后到期，之后每1秒触发一次 */</span></span><br><span class="line">    k_timer_start(&amp;my_timer, K_SECONDS(<span class="number">2</span>), K_SECONDS(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 等待 5 秒 */</span></span><br><span class="line">    k_sleep(K_SECONDS(<span class="number">5</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 获取剩余时间 */</span></span><br><span class="line">    <span class="type">int32_t</span> remaining = k_timer_remaining_get(&amp;my_timer);</span><br><span class="line">    printk(<span class="string">&quot;Remaining time: %d ms\n&quot;</span>, remaining);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 获取定时器状态 */</span></span><br><span class="line">    <span class="type">uint32_t</span> status = k_timer_status_get(&amp;my_timer);</span><br><span class="line">    printk(<span class="string">&quot;Timer expired %u times\n&quot;</span>, status);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 等待 2 秒 */</span></span><br><span class="line">    k_sleep(K_SECONDS(<span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 停止定时器 */</span></span><br><span class="line">    k_timer_stop(&amp;my_timer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 使用单次定时器 */</span></span><br><span class="line">    printk(<span class="string">&quot;Starting one-shot timer\n&quot;</span>);</span><br><span class="line">    k_timer_start(&amp;my_timer, K_SECONDS(<span class="number">1</span>), K_NO_WAIT);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 等待定时器到期 */</span></span><br><span class="line">    k_timer_status_sync(&amp;my_timer);</span><br><span class="line">    printk(<span class="string">&quot;One-shot timer expired\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    printk(<span class="string">&quot;Timer example completed\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>prj.conf</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 不需要特殊配置</span><br></pre></td></tr></table></figure>

<h3 id="构建和运行-3"><a href="#构建和运行-3" class="headerlink" title="构建和运行"></a>构建和运行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">west build -b &lt;board&gt; samples/basic/timer</span><br><span class="line">west flash</span><br></pre></td></tr></table></figure>

<h3 id="代码说明-3"><a href="#代码说明-3" class="headerlink" title="代码说明"></a>代码说明</h3><ol>
<li><code>K_TIMER_DEFINE()</code> - 定义定时器</li>
<li><code>k_timer_start()</code> - 启动定时器</li>
<li><code>k_timer_remaining_get()</code> - 获取剩余时间</li>
<li><code>k_timer_status_get()</code> - 获取定时器状态</li>
<li><code>k_timer_stop()</code> - 停止定时器</li>
<li><code>k_timer_status_sync()</code> - 同步等待定时器到期</li>
<li><code>k_uptime_get_32()</code> - 获取系统启动后的毫秒数</li>
</ol>
<h2 id="多线程编程"><a href="#多线程编程" class="headerlink" title="多线程编程"></a>多线程编程</h2><p>这个示例展示了如何在 Zephyr 中创建和使用多个线程。</p>
<h3 id="源代码-4"><a href="#源代码-4" class="headerlink" title="源代码"></a>源代码</h3><p><strong>src&#x2F;main.c</strong>:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Copyright (c) 2023 Your Name</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * SPDX-License-Identifier: Apache-2.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/kernel.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zephyr/sys/printk.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义线程栈大小 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STACK_SIZE 1024</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义线程优先级 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> THREAD_A_PRIORITY 5</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> THREAD_B_PRIORITY 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义线程栈和数据 */</span></span><br><span class="line">K_THREAD_STACK_DEFINE(thread_a_stack, STACK_SIZE);</span><br><span class="line">K_THREAD_STACK_DEFINE(thread_b_stack, STACK_SIZE);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">k_thread</span> <span class="title">thread_a_data</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">k_thread</span> <span class="title">thread_b_data</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义信号量用于同步 */</span></span><br><span class="line">K_SEM_DEFINE(sem_a, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">K_SEM_DEFINE(sem_b, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 线程 A 入口函数 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">thread_a_entry</span><span class="params">(<span class="type">void</span> *p1, <span class="type">void</span> *p2, <span class="type">void</span> *p3)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">/* 等待信号量 */</span></span><br><span class="line">        k_sem_take(&amp;sem_a, K_FOREVER);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 执行任务 */</span></span><br><span class="line">        printk(<span class="string">&quot;Thread A running, count: %d\n&quot;</span>, count++);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 延时 1 秒 */</span></span><br><span class="line">        k_sleep(K_SECONDS(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 释放线程 B 的信号量 */</span></span><br><span class="line">        k_sem_give(&amp;sem_b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 线程 B 入口函数 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">thread_b_entry</span><span class="params">(<span class="type">void</span> *p1, <span class="type">void</span> *p2, <span class="type">void</span> *p3)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">/* 等待信号量 */</span></span><br><span class="line">        k_sem_take(&amp;sem_b, K_FOREVER);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 执行任务 */</span></span><br><span class="line">        printk(<span class="string">&quot;Thread B running, count: %d\n&quot;</span>, count++);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 延时 1 秒 */</span></span><br><span class="line">        k_sleep(K_SECONDS(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 释放线程 A 的信号量 */</span></span><br><span class="line">        k_sem_give(&amp;sem_a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    printk(<span class="string">&quot;Multi-threading example started\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 创建线程 A */</span></span><br><span class="line">    k_thread_create(&amp;thread_a_data, thread_a_stack,</span><br><span class="line">                    K_THREAD_STACK_SIZEOF(thread_a_stack),</span><br><span class="line">                    thread_a_entry, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>,</span><br><span class="line">                    THREAD_A_PRIORITY, <span class="number">0</span>, K_NO_WAIT);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 创建线程 B */</span></span><br><span class="line">    k_thread_create(&amp;thread_b_data, thread_b_stack,</span><br><span class="line">                    K_THREAD_STACK_SIZEOF(thread_b_stack),</span><br><span class="line">                    thread_b_entry, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>,</span><br><span class="line">                    THREAD_B_PRIORITY, <span class="number">0</span>, K_NO_WAIT);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 设置线程名称（如果启用） */</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> CONFIG_THREAD_NAME</span></span><br><span class="line">    k_thread_name_set(&amp;thread_a_data, <span class="string">&quot;thread_a&quot;</span>);</span><br><span class="line">    k_thread_name_set(&amp;thread_b_data, <span class="string">&quot;thread_b&quot;</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 启动线程 A */</span></span><br><span class="line">    k_sem_give(&amp;sem_a);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 主线程工作 */</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        printk(<span class="string">&quot;Main thread running\n&quot;</span>);</span><br><span class="line">        k_sleep(K_SECONDS(<span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>prj.conf</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONFIG_THREAD_NAME=y</span><br></pre></td></tr></table></figure>

<h3 id="构建和运行-4"><a href="#构建和运行-4" class="headerlink" title="构建和运行"></a>构建和运行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">west build -b &lt;board&gt; samples/basic/threads</span><br><span class="line">west flash</span><br></pre></td></tr></table></figure>

<h3 id="代码说明-4"><a href="#代码说明-4" class="headerlink" title="代码说明"></a>代码说明</h3><ol>
<li><code>K_THREAD_STACK_DEFINE()</code> - 定义线程栈</li>
<li><code>K_SEM_DEFINE()</code> - 定义信号量</li>
<li><code>k_thread_create()</code> - 创建线程</li>
<li><code>k_thread_name_set()</code> - 设置线程名称</li>
<li><code>k_sem_take()</code> - 获取信号量</li>
<li><code>k_sem_give()</code> - 释放信号量</li>
</ol>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这些基础示例展示了 Zephyr RTOS 的核心功能，包括基本输出、GPIO 控制、中断处理、定时器使用和多线程编程。通过学习和实践这些示例，您可以快速掌握 Zephyr 开发的基础知识，为更复杂的应用开发打下基础。</p>
<p>每个示例都可以独立构建和运行，并且可以根据需要进行修改和扩展。建议初学者按照顺序学习这些示例，从简单到复杂，逐步掌握 Zephyr RTOS 的各项功能。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://joeforkyou.github.io">JoeNero</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://joeforkyou.github.io/2023/12/21/nodic/zephyr/examples/basic/">https://joeforkyou.github.io/2023/12/21/nodic/zephyr/examples/basic/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/zephyr/">zephyr</a><a class="post-meta__tags" href="/tags/embedded/">embedded</a><a class="post-meta__tags" href="/tags/examples/">examples</a></div><div class="post-share"><div class="social-share" data-image="/img/%E7%BE%8E%E5%A5%B3.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2023/12/21/nodic/zephyr/development/application/" title="Zephyr 应用程序开发"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Zephyr 应用程序开发</div></div><div class="info-2"><div class="info-item-1">版本信息 版本：V1.0 更新时间：2025年03月21日 02:15  Zephyr 应用程序开发本文档详细介绍了 Zephyr RTOS 应用程序的开发过程，包括应用程序结构、配置系统、构建系统以及实际示例。 应用程序结构基本结构一个典型的 Zephyr 应用程序目录结构如下： 1234567891011121314151617app/├── CMakeLists.txt           # CMake 构建脚本├── prj.conf                 # 项目配置文件├── app.overlay             # 设备树覆盖文件（可选）├── src/                    # 源代码目录│   ├── main.c             # 主程序│   ├── app_version.h      # 版本信息│   └── ...               # 其他源文件├── include/               # 头文件目录│   ├── app_config.h      # 应用配置头文件│  ...</div></div></div></a><a class="pagination-related" href="/2023/12/21/nodic/zephyr/quick_start/README/" title="Zephyr RTOS 快速入门指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Zephyr RTOS 快速入门指南</div></div><div class="info-2"><div class="info-item-1">Zephyr RTOS 快速入门本章节将帮助您快速上手 Zephyr RTOS 开发。 环境搭建系统要求Zephyr 开发环境支持以下操作系统：  Windows 10 或更新版本（推荐使用 WSL2） macOS 10.15 或更新版本 Ubuntu 18.04 或更新版本 其他 Linux 发行版  安装工具链 安装依赖工具 12345# Ubuntu/Debiansudo apt install --no-install-recommends git cmake ninja-build gperfsudo apt install ccache dfu-util device-tree-compiler wgetsudo apt install python3-dev python3-pip python3-setuptools python3-tk python3-wheel xz-utils filesudo apt install make gcc gcc-multilib g++-multilib libsdl2-dev  安装 West 工具 123pip3...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2023/12/21/nodic/zephyr/README/" title="Zephyr RTOS 学习指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-21</div><div class="info-item-2">Zephyr RTOS 学习指南</div></div><div class="info-2"><div class="info-item-1">Zephyr RTOS 学习指南版本信息 版本：V1.0 更新时间：2025年03月20日 22:09  目录结构 快速入门  环境搭建 Hello World 示例 基本概念   系统架构  内核架构 硬件支持 设备树 驱动模型   核心模块  内核模块 线程管理 内存管理 中断处理 定时器   驱动系统 GPIO UART SPI I2C   网络协议栈 文件系统 电源管理   开发指南  应用开发流程 驱动开发指南 调试技巧 测试框架 贡献指南   示例代码  基础示例 网络示例 传感器示例 蓝牙示例   硬件支持  支持的开发板 添加新板子 硬件抽象层   工具链  构建系统 IDE支持 调试工具 安装指南   常见问题  编译问题 运行问题 开发问题    文档说明本文档旨在帮助开发者快速上手 Zephyr RTOS，涵盖了从入门到进阶的完整学习路径。基于 Zephyr v2.9.1...</div></div></div></a><a class="pagination-related" href="/2023/12/21/nodic/zephyr/architecture/devicetree/" title="Zephyr 设备树"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-21</div><div class="info-item-2">Zephyr 设备树</div></div><div class="info-2"><div class="info-item-1">Zephyr 设备树版本信息 版本：V1.0 更新时间：2025年03月20日 23:15  设备树（Device Tree）是 Zephyr RTOS 用于描述硬件配置的机制。它提供了一种统一的方式来描述系统硬件，使得硬件配置与软件代码分离，提高了代码的可移植性和可维护性。 设备树概述什么是设备树设备树是一种描述硬件的数据结构，它以树形结构表示硬件设备及其属性。在 Zephyr 中，设备树用于：  描述硬件配置 生成设备驱动的初始化代码 配置中断和引脚复用 定义内存映射  设备树的优势 硬件描述与软件分离：便于硬件配置的修改和维护 跨平台兼容性：同一套代码可以适用于不同的硬件平台 动态配置：支持运行时修改设备配置 标准化：采用行业标准的描述方式，提高可读性和互操作性  设备树语法基本结构设备树文件（.dts）的基本结构如下： 123456789101112131415161718/dts-v1/;/ &#123;    model = &quot;Example Board&quot;;    compatible = &quot;example,board&quot;;  ...</div></div></div></a><a class="pagination-related" href="/2023/12/21/nodic/zephyr/development/application/" title="Zephyr 应用程序开发"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-21</div><div class="info-item-2">Zephyr 应用程序开发</div></div><div class="info-2"><div class="info-item-1">版本信息 版本：V1.0 更新时间：2025年03月21日 02:15  Zephyr 应用程序开发本文档详细介绍了 Zephyr RTOS 应用程序的开发过程，包括应用程序结构、配置系统、构建系统以及实际示例。 应用程序结构基本结构一个典型的 Zephyr 应用程序目录结构如下： 1234567891011121314151617app/├── CMakeLists.txt           # CMake 构建脚本├── prj.conf                 # 项目配置文件├── app.overlay             # 设备树覆盖文件（可选）├── src/                    # 源代码目录│   ├── main.c             # 主程序│   ├── app_version.h      # 版本信息│   └── ...               # 其他源文件├── include/               # 头文件目录│   ├── app_config.h      # 应用配置头文件│  ...</div></div></div></a><a class="pagination-related" href="/2023/12/21/nodic/zephyr/quick_start/README/" title="Zephyr RTOS 快速入门指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-21</div><div class="info-item-2">Zephyr RTOS 快速入门指南</div></div><div class="info-2"><div class="info-item-1">Zephyr RTOS 快速入门本章节将帮助您快速上手 Zephyr RTOS 开发。 环境搭建系统要求Zephyr 开发环境支持以下操作系统：  Windows 10 或更新版本（推荐使用 WSL2） macOS 10.15 或更新版本 Ubuntu 18.04 或更新版本 其他 Linux 发行版  安装工具链 安装依赖工具 12345# Ubuntu/Debiansudo apt install --no-install-recommends git cmake ninja-build gperfsudo apt install ccache dfu-util device-tree-compiler wgetsudo apt install python3-dev python3-pip python3-setuptools python3-tk python3-wheel xz-utils filesudo apt install make gcc gcc-multilib g++-multilib libsdl2-dev  安装 West 工具 123pip3...</div></div></div></a><a class="pagination-related" href="/2025/03/20/zephyer/zephyer1/" title="【Zephyr】【一】Zephyr RTOS 示例代码集"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-20</div><div class="info-item-2">【Zephyr】【一】Zephyr RTOS 示例代码集</div></div><div class="info-2"><div class="info-item-1">Zephyr RTOS 示例代码集1. 基础示例1.0 基础配置每个示例都需要一个 prj.conf 文件来配置项目。以下是各个示例所需的配置： 基础示例 prj.conf1234567891011# 控制台输出CONFIG_PRINTK=yCONFIG_SERIAL=yCONFIG_UART_CONSOLE=y# 日志系统CONFIG_LOG=yCONFIG_LOG_DEFAULT_LEVEL=3# 内核配置CONFIG_KERNEL_BIN_NAME=&quot;app&quot;  线程示例 prj.conf123456789# 基础配置CONFIG_PRINTK=yCONFIG_SERIAL=yCONFIG_UART_CONSOLE=y# 线程配置CONFIG_THREAD_NAME=yCONFIG_THREAD_MONITOR=yCONFIG_THREAD_STACK_INFO=y  1.1 Hello...</div></div></div></a><a class="pagination-related" href="/2025/03/20/zephyer/zephyr2/" title="【Zephyr】【二】Zephyr RTOS 系统架构"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-20</div><div class="info-item-2">【Zephyr】【二】Zephyr RTOS 系统架构</div></div><div class="info-2"><div class="info-item-1"> mermaid.initialize({startOnLoad:true});  Zephyr RTOS 系统架构整体架构 graph TB     subgraph "应用层"         App1[应用1]         App2[应用2]         App3[应用3]     end     subgraph "系统服务层"         FS[文件系统]         Net[网络协议栈]         Shell[命令行界面]     end     subgraph "内核层"         Sched[调度器]         Mem[内存管理]         IPC[进程间通信]         Time[时间管理]     end     subgraph "硬件抽象层"         GPIO[GPIO驱动]         UART[串口驱动]         SPI[SPI驱动]         I2C[I2C驱动]     end     App1 & App2 & App3 --> FS & Net & Shell    ...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/%E7%BE%8E%E5%A5%B3.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">JoeNero</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">128</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">27</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/JoeForkYou"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/JoeForkYou" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:17549663745@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">wow!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Zephyr-%E5%9F%BA%E7%A1%80%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.</span> <span class="toc-text">Zephyr 基础示例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Hello-World"><span class="toc-number">1.1.</span> <span class="toc-text">Hello World</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">1.1.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%92%8C%E8%BF%90%E8%A1%8C"><span class="toc-number">1.1.2.</span> <span class="toc-text">构建和运行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C"><span class="toc-number">1.1.3.</span> <span class="toc-text">输出结果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%AF%B4%E6%98%8E"><span class="toc-number">1.1.4.</span> <span class="toc-text">代码说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LED-%E6%8E%A7%E5%88%B6"><span class="toc-number">1.2.</span> <span class="toc-text">LED 控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%92%8C%E8%BF%90%E8%A1%8C-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">构建和运行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%AF%B4%E6%98%8E-1"><span class="toc-number">1.2.3.</span> <span class="toc-text">代码说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%89%E9%94%AE%E8%BE%93%E5%85%A5"><span class="toc-number">1.3.</span> <span class="toc-text">按键输入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%92%8C%E8%BF%90%E8%A1%8C-2"><span class="toc-number">1.3.2.</span> <span class="toc-text">构建和运行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%AF%B4%E6%98%8E-2"><span class="toc-number">1.3.3.</span> <span class="toc-text">代码说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E6%97%B6%E5%99%A8%E4%BD%BF%E7%94%A8"><span class="toc-number">1.4.</span> <span class="toc-text">定时器使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-3"><span class="toc-number">1.4.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%92%8C%E8%BF%90%E8%A1%8C-3"><span class="toc-number">1.4.2.</span> <span class="toc-text">构建和运行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%AF%B4%E6%98%8E-3"><span class="toc-number">1.4.3.</span> <span class="toc-text">代码说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%BC%96%E7%A8%8B"><span class="toc-number">1.5.</span> <span class="toc-text">多线程编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81-4"><span class="toc-number">1.5.1.</span> <span class="toc-text">源代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%92%8C%E8%BF%90%E8%A1%8C-4"><span class="toc-number">1.5.2.</span> <span class="toc-text">构建和运行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%AF%B4%E6%98%8E-4"><span class="toc-number">1.5.3.</span> <span class="toc-text">代码说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.6.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/05/C/C/" title="C 语言高级编程指南：回调函数与设计模式">C 语言高级编程指南：回调函数与设计模式</a><time datetime="2025-04-05T06:13:08.000Z" title="Created 2025-04-05 14:13:08">2025-04-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/04/CPP/CPP%E5%9F%BA%E7%A1%80_5_%E9%80%9F%E9%80%9A/" title="【CPP基础】【五】【CPP速通】">【CPP基础】【五】【CPP速通】</a><time datetime="2025-04-04T08:51:04.000Z" title="Created 2025-04-04 16:51:04">2025-04-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/21/nodic/zephyr/core/drivers/" title="drivers">drivers</a><time datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/21/nodic/zephyr/core/filesystem/" title="filesystem">filesystem</a><time datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/21/nodic/zephyr/core/hardware/" title="hardware">hardware</a><time datetime="2025-03-21T12:49:56.000Z" title="Created 2025-03-21 20:49:56">2025-03-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By JoeNero</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.<p><a target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/lite/builds/browser.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div></div></body></html>